<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded GarageBand: uart.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Picture1.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded GarageBand&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The project is aimed at developing an embedded Garage band that uses an 8051 microcontroller. The user can access the instruments via the touchscreen+graphics LCD or use the instruments that we have constructed. In this document we will cover the complete detail of the project including its construction, hardware design, software design and debugging.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('uart_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">uart.h</div>  </div>
</div>
<div class="contents">
<a href="uart_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**************************************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">  Filename:       uart.h</span>
<a name="l00003"></a>00003 <span class="comment">  Revised:        $Date: 2009-08-17 10:50:58 -0700 (Mon, 17 Aug 2009) $</span>
<a name="l00004"></a>00004 <span class="comment">  Author:         $Author: jnoxon $</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">  Description:    This header file supports the SimpliciTI-compatible UART driver.</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">    Code leveraged from Texas Instruments, Inc.</span>
<a name="l00009"></a>00009 <span class="comment">        Modified by:    Niket Shah</span>
<a name="l00010"></a>00010 <span class="comment">                                        Maulik Kapuria</span>
<a name="l00011"></a>00011 <span class="comment">                                        Vishal Verma</span>
<a name="l00012"></a>00012 <span class="comment">**************************************************************************************************/</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef uart_h</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#define uart_h</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="comment">/******************************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> * INCLUDES</span>
<a name="l00019"></a>00019 <span class="comment"> */</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;stdbool.h&gt;</span> <span class="comment">/* supports bool, true, and false */</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;stddef.h&gt;</span>  <span class="comment">/* supports NULL macro */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">/* ------------------------------------------------------------------------------------------------</span>
<a name="l00024"></a>00024 <span class="comment"> *                                UART Settings</span>
<a name="l00025"></a>00025 <span class="comment"> * ------------------------------------------------------------------------------------------------</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a><a class="code" href="uart_8h.html#aeeae310a557480086aa3c56a950e8b64">00027</a> <span class="preprocessor">#define RX_TX_BUFFER_SIZE  50      </span><span class="comment">/* Size of transmit FIFO and receive FIFO */</span>
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="uart_8h.html#ade8f2cab3a291c17f2c82046c7dd50b0">00029</a> <span class="preprocessor">#define UART0_BAUD_RATE    115200</span>
<a name="l00030"></a><a class="code" href="uart_8h.html#a9715f79cf910e2d5d89d0bd4eba81831">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define UART1_BAUD_RATE    115200</span>
<a name="l00031"></a><a class="code" href="uart_8h.html#a1db1457c1ec401a81da0c7d2dae88607">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_FLOW_CONTROL  UART_FLOW_CONTROL_OFF  </span><span class="comment">/* _ON or _OFF */</span>
<a name="l00032"></a><a class="code" href="uart_8h.html#a82edc7fac3f5bbdd56b34f890885bb7b">00032</a> <span class="preprocessor">#define UART_PARITY_MODE   UART_PARITY_NONE      </span><span class="comment">/* _NONE, _EVEN, or _ODD */</span>
<a name="l00033"></a><a class="code" href="uart_8h.html#a5a50a502408c7bea025124b526ca381c">00033</a> <span class="preprocessor">#define UART_STOP_BITS     UART_1_STOP_BIT       </span><span class="comment">/* _1_STOP_BIT or _2_STOP_BITS */</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="comment">/* ------------------------------------------------------------------------------------------------</span>
<a name="l00037"></a>00037 <span class="comment"> *                                8051-Specific Settings</span>
<a name="l00038"></a>00038 <span class="comment"> * ------------------------------------------------------------------------------------------------</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">/* Specify USART module to use for UART:</span>
<a name="l00042"></a>00042 <span class="comment"> *   If using an 8051-based SoC on a SmartRF®04 and SmartRF®05 board, choose</span>
<a name="l00043"></a>00043 <span class="comment"> *   UART_NUMBER = UART_NUMBER_0      and      UART_LOCATION = UART_LOCATION_1</span>
<a name="l00044"></a>00044 <span class="comment"> *   to map UART to on-board RS-232 transceivers for serial communication  */</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046  <span class="comment">// #define UART_NUMBER     UART_NUMBER_1          // _0 or _1</span>
<a name="l00047"></a>00047   <span class="comment">//#define UART_LOCATION   UART_LOCATION_2        // _1 or _2</span>
<a name="l00048"></a><a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">00048</a> <span class="preprocessor">  #define UART0_LOCATION   UART_LOCATION_2        // _1 or _2</span>
<a name="l00049"></a><a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">00049</a> <span class="preprocessor"></span><span class="preprocessor">  #define UART1_LOCATION   UART_LOCATION_2        // _1 or _2</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/******************************************************************************</span>
<a name="l00056"></a>00056 <span class="comment"> * CONSTANTS AND DEFINES</span>
<a name="l00057"></a>00057 <span class="comment"> */</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">/* clock definition</span>
<a name="l00060"></a>00060 <span class="comment"> * this allows for the user to modify the clock rate used in subsequent</span>
<a name="l00061"></a>00061 <span class="comment"> * calculations by defining a different value at the project level. */</span>
<a name="l00062"></a>00062 <span class="preprocessor">#ifndef UART_CLOCK_MHZ</span>
<a name="l00063"></a><a class="code" href="uart_8h.html#adbc4b84dcbedfc1b1764aa35557e7a2f">00063</a> <span class="preprocessor"></span><span class="preprocessor">  #define UART_CLOCK_MHZ 32</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00066"></a>00066 <span class="comment">/* constants of operation */</span>
<a name="l00067"></a><a class="code" href="uart_8h.html#a4ad74858f2e276de15c5eee5573db1e7">00067</a> <span class="preprocessor">#define UART_IRQ_ENABLED   1</span>
<a name="l00068"></a><a class="code" href="uart_8h.html#ace96581ef56b424cf488cdf975427d42">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_DISABLED  0</span>
<a name="l00069"></a><a class="code" href="uart_8h.html#a0aa1ca7de235808e5333c555a150f567">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_PENDING   1</span>
<a name="l00070"></a><a class="code" href="uart_8h.html#a47ea05a3f0cc9f9eff7f60bb9834f842">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_IDLE      0</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a>00072 <span class="comment">/* uart hardware flow control options */</span>
<a name="l00073"></a><a class="code" href="uart_8h.html#a783f1232fc69d8e6fd7357d1a548829c">00073</a> <span class="preprocessor">#define UART_FLOW_CONTROL_ON  1</span>
<a name="l00074"></a><a class="code" href="uart_8h.html#a27a3e1a0b8089fb67e7d1aca05bc8238">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_FLOW_CONTROL_OFF 0</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a>00076 <span class="comment">/* uart parity enabled status */</span>
<a name="l00077"></a><a class="code" href="uart_8h.html#a270dea6e1a92dd83fe58802450bdd60c">00077</a> <span class="preprocessor">#define UART_PARITY_NONE 0</span>
<a name="l00078"></a><a class="code" href="uart_8h.html#a063b14ac42ef9e8f4246c17a586b14eb">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_PARITY_EVEN 1</span>
<a name="l00079"></a><a class="code" href="uart_8h.html#a229615e64964f68f7a856ea6ffea359e">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_PARITY_ODD  2</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span>
<a name="l00081"></a>00081 <span class="comment">/* uart number of stops bits to use */</span>
<a name="l00082"></a><a class="code" href="uart_8h.html#ac4990a089c55023de7a3d52d24ad754d">00082</a> <span class="preprocessor">#define UART_1_STOP_BIT   0</span>
<a name="l00083"></a><a class="code" href="uart_8h.html#aecf65d18944359398a7a62c7b70aaab8">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define UART_2_STOP_BITS  1</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span>
<a name="l00085"></a>00085 <span class="comment">/* common target definitions and set default values for any not defined</span>
<a name="l00086"></a>00086 <span class="comment"> * by the user */</span>
<a name="l00087"></a>00087 <span class="preprocessor">#ifndef UART_BAUD_RATE</span>
<a name="l00088"></a><a class="code" href="uart_8h.html#a615aed21aa6825462b7c17b0c238ffe2">00088</a> <span class="preprocessor"></span><span class="preprocessor">  #define UART_BAUD_RATE 9600</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#ifndef UART_FLOW_CONTROL</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span><span class="preprocessor">  #define UART_FLOW_CONTROL  UART_FLOW_CONTROL_ON</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#ifndef UART_PARITY_MODE</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">  #define UART_PARITY_MODE   UART_PARITY_NONE</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#ifndef UART_STOP_BITS</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">  #define UART_STOP_BITS     UART_1_STOP_BIT</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00100"></a>00100 <span class="comment">/* BSP Definitions */</span>
<a name="l00101"></a><a class="code" href="uart_8h.html#adc795169be24d2504ad2242be35cb85c">00101</a> <span class="preprocessor">#define __bsp_ISTATE_T__            unsigned short</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a><a class="code" href="uart_8h.html#af44924e630aeca49a965c204ed740dd5">00103</a> <span class="preprocessor">#define __bsp_ENABLE_INTERRUPTS__()         st( EA = 1; )</span>
<a name="l00104"></a><a class="code" href="uart_8h.html#ac753ce83b5536ef449e0a90255c193ee">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define __bsp_DISABLE_INTERRUPTS__()        st( EA = 0; )</span>
<a name="l00105"></a><a class="code" href="uart_8h.html#a4daaf2b7363a2d28de5e569a3fe11bd9">00105</a> <span class="preprocessor"></span><span class="preprocessor">#define __bsp_INTERRUPTS_ARE_ENABLED__()    EA</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span>
<a name="l00107"></a><a class="code" href="uart_8h.html#a1fa0308d7ad00543939c0898d88d641c">00107</a> <span class="preprocessor">#define __bsp_GET_ISTATE__()                EA</span>
<a name="l00108"></a><a class="code" href="uart_8h.html#aa8bdfbcb9f7994f5e9649f0fb2281fa4">00108</a> <span class="preprocessor"></span><span class="preprocessor">#define __bsp_RESTORE_ISTATE__(x)           st( EA = x; )</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a><a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">00110</a> <span class="keyword">typedef</span> <a class="code" href="uart_8h.html#adc795169be24d2504ad2242be35cb85c">__bsp_ISTATE_T__</a>  <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">00112</a> <span class="preprocessor">#define BSP_ENTER_CRITICAL_SECTION(x)   st( x = __bsp_GET_ISTATE__(); __bsp_DISABLE_INTERRUPTS__(); )</span>
<a name="l00113"></a><a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">00113</a> <span class="preprocessor"></span><span class="preprocessor">#define BSP_EXIT_CRITICAL_SECTION(x)    __bsp_RESTORE_ISTATE__(x)</span>
<a name="l00114"></a><a class="code" href="uart_8h.html#af2a42700803cd5bf6844980aed5da0e1">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define BSP_CRITICAL_STATEMENT(x)       st( bspIState_t s;                    \</span>
<a name="l00115"></a>00115 <span class="preprocessor">                                            BSP_ENTER_CRITICAL_SECTION(s);    \</span>
<a name="l00116"></a>00116 <span class="preprocessor">                                            x;                                \</span>
<a name="l00117"></a>00117 <span class="preprocessor">                                            BSP_EXIT_CRITICAL_SECTION(s); )</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>
<a name="l00119"></a><a class="code" href="uart_8h.html#a2e8173b720a3eed301262ae808ee976d">00119</a> <span class="preprocessor">#define st(x)      do { x } while (__LINE__ == -1)</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">/* ------------------------------------------------------------------------------------------------</span>
<a name="l00124"></a>00124 <span class="comment"> *                          MACROS AND DEFINES FOR ALL 8051 VARIANTS</span>
<a name="l00125"></a>00125 <span class="comment"> * ------------------------------------------------------------------------------------------------</span>
<a name="l00126"></a>00126 <span class="comment"> */</span>
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="preprocessor">#if ( defined __IAR_SYSTEMS_ICC__ ) &amp;&amp; ( defined __ICC8051__ )</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a>00130 <span class="preprocessor">#include &quot;ioCC2430.h&quot;</span>
<a name="l00131"></a>00131 <span class="preprocessor">#include &quot;<a class="code" href="pp__utils_8h.html">pp_utils.h</a>&quot;</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="comment">/*  Map bit-fields in CPU registers that macros will access. This mapping has</span>
<a name="l00134"></a>00134 <span class="comment"> * been tested for CC1110/1, CC2510/1, CC2430/1, CC2530. If using an 8051-based</span>
<a name="l00135"></a>00135 <span class="comment"> * SoC apart from those, check the below mapping with the part datasheet or</span>
<a name="l00136"></a>00136 <span class="comment"> * guide */</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="preprocessor">#define SFRUNION( name, addr, ... ) __sfr __no_init volatile \</span>
<a name="l00139"></a>00139 <span class="preprocessor">          DECL_BIT_FIELD_UNION( , , unsigned char, name, , __VA_ARGS__ ) @ addr</span>
<a name="l00140"></a>00140 <span class="preprocessor"></span>
<a name="l00141"></a>00141 SFRUNION( _IEN2_,    0x9A, <a class="code" href="pp__utils_8h.html#a9d05162f30c9ebb787857317d986e19d">DECL_BIT_FIELDS_7</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, , 2, WDTIE, 1, P1IE, 1, UTX1IE, 1, UTX0IE, 1, P2IE, 1, RFIE, 1 ) );
<a name="l00142"></a>00142 SFRUNION( _PERCFG_,  0xF1, <a class="code" href="pp__utils_8h.html#a9d05162f30c9ebb787857317d986e19d">DECL_BIT_FIELDS_7</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, , 1, T1CFG, 1, T3CFG, 1, T4CFG, 1, , 2, U1CFG, 1, U0CFG, 1 ) );
<a name="l00143"></a>00143 SFRBIT(  _ADCCFG_,   0xF2, ADCCFG7, ADCCFG6, ADCCFG5, ADCCFG4, ADCCFG3, ADCCFG2, ADCCFG1, ADCCFG0 );
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 SFRBIT(  _P0SEL_,    0xF3, SELP0_7, SELP0_6, SELP0_5, SELP0_4, SELP0_3, SELP0_2, SELP0_1, SELP0_0 );
<a name="l00146"></a>00146 SFRBIT(  _P1SEL_,    0xF4, SELP1_7, SELP1_6, SELP1_5, SELP1_4, SELP1_3, SELP1_2, SELP1_1, SELP1_0 );
<a name="l00147"></a>00147 SFRBIT(  _P2SEL_,    0xF5, , PRI3P1, PRI2P1, PRI1P1, PRI0P1, SELP2_4, SELP2_3, SELP2_0 );
<a name="l00148"></a>00148 SFRBIT( _P0DIR_,     0xFD, DIRP0_7, DIRP0_6, DIRP0_5, DIRP0_4, DIRP0_3, DIRP0_2, DIRP0_1, DIRP0_0 );
<a name="l00149"></a>00149 SFRBIT( _P1DIR_,     0xFE, DIRP1_7, DIRP1_6, DIRP1_5, DIRP1_4, DIRP1_3, DIRP1_2, DIRP1_1, DIRP1_0 );
<a name="l00150"></a>00150 SFRUNION( _P2DIR_,   0xFF, <a class="code" href="pp__utils_8h.html#a9d05162f30c9ebb787857317d986e19d">DECL_BIT_FIELDS_7</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, PRIP0, 2, , 1, DIRP2_4, 1, DIRP2_3, 1, DIRP2_2, 1, DIRP2_1, 1, DIRP2_0, 1 ) );
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 SFRBIT( _U0CSR_   ,  0x86, U0MODE, U0RE, U0SLAVE, U0FE, U0ERR, U0RX_BYTE, U0TX_BYTE, U0ACTIVE );
<a name="l00153"></a>00153 SFRBIT( _U0UCR_   ,  0xC4 , U0FLUSH, U0FLOW, U0D9, U0BIT9, U0PARITY, U0SPB, U0STOP, U0START );
<a name="l00154"></a>00154 SFRUNION( _U0GCR_,   0xC5, <a class="code" href="pp__utils_8h.html#a88478a72bcca40e870af0ba8e09ea5b0">DECL_BIT_FIELDS_4</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, U0CPOL, 1, U0CPHA, 1, U0ORDER, 1, U0BAUD_E, 5 ) );
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 SFRBIT( _U1UCR_   ,  0xFB , U1FLUSH, U1FLOW, U1D9, U1BIT9, U1PARITY, U1SPB, U1STOP, U1START );
<a name="l00157"></a>00157 SFRUNION( _U1GCR_,   0xFC, <a class="code" href="pp__utils_8h.html#a88478a72bcca40e870af0ba8e09ea5b0">DECL_BIT_FIELDS_4</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>, U1CPOL, 1, U1CPHA, 1, U1ORDER, 1, U1BAUD_E, 5 ) );
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">/*                IRQ VECTOR INFORMATION AND INTERRUPT MANAGEMENT             */</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="preprocessor">#define UART_IRQ_VECTOR( uart, func ) INFIX( CONCATENATE( U, func ), uart, _VECTOR )</span>
<a name="l00164"></a>00164 <span class="preprocessor"></span>
<a name="l00165"></a>00165 <span class="comment">/* irq enable/disable macros */</span>
<a name="l00166"></a>00166 <span class="preprocessor">#define UART_IRQ_STATE( uart, loc, func )    INFIX( CONCATENATE( U, func ), uart, IE )</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_ENABLE( uart, loc, func )   ( UART_IRQ_STATE( uart, loc, func ) = UART_IRQ_ENABLED )</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_DISABLE( uart, loc, func )  ( UART_IRQ_STATE( uart, loc, func ) = UART_IRQ_DISABLED )</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>
<a name="l00170"></a>00170 <span class="comment">/* irq flag macros */</span>
<a name="l00171"></a>00171 <span class="preprocessor">#define UART_IRQ_FLAG( uart, func )       INFIX( CONCATENATE( U, func ), uart, IF )</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_IS_PENDING( uart, func ) ( UART_IRQ_FLAG( uart, func ) == UART_IRQ_PENDING )</span>
<a name="l00173"></a>00173 <span class="preprocessor"></span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="comment">/*                        UART IDENTIFIER PREAMBLE BUILDERS                   */</span>
<a name="l00177"></a>00177 <span class="preprocessor">#define UART_NUMBER_0    0</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span><span class="preprocessor">#define UART_NUMBER_1    1</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span><span class="preprocessor">#define UART_LOCATION_1  1</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span><span class="preprocessor">#define UART_LOCATION_2  2</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span><span class="preprocessor">#define UART_UART( uart )          INFIX( UART, _, uart )</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span><span class="preprocessor">#define UART_LOC( loc )            INFIX( LOC, _, loc )</span>
<a name="l00183"></a>00183 <span class="preprocessor"></span><span class="preprocessor">#define UART_PREAMBLE( uart, loc ) INFIX( UART_UART( uart ), _, UART_LOC( loc ) )</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="comment">/*                           UART PORT USAGE MACROS                           */</span>
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">/* uart ==&gt; 0 or 1, loc ==&gt; 1 or 2, returns UART_&lt;uart&gt;_LOC_&lt;loc&gt;_PORT */</span>
<a name="l00190"></a>00190 <span class="preprocessor">#define UART_PORT( uart, loc ) INFIX( UART_PREAMBLE( uart, loc ), _, PORT )</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span>
<a name="l00192"></a>00192 <span class="preprocessor">#define UART_0_LOC_1_PORT 0</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_2_PORT 1</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_1_PORT 0</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_2_PORT 1</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>
<a name="l00197"></a>00197 <span class="comment">/*                          UART PORT PIN MACROS                              */</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">/* uart ==&gt; 0 or 1, loc ==&gt; 1 or 2, func ==&gt; RX or TX or RT or CT */</span>
<a name="l00200"></a>00200 <span class="comment">/* returns UART_&lt;uart&gt;_LOC_&lt;loc&gt;_&lt;func&gt;_BIT */</span>
<a name="l00201"></a>00201 <span class="preprocessor">#define UART_PIN( uart, loc, func ) INFIX( UART_PREAMBLE( uart, loc ), _, UART_PIN_FUNC( func ) )</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>
<a name="l00203"></a>00203 <span class="comment">/* func ==&gt; RX or TX or RT or CT, returns &lt;func&gt;_BIT */</span>
<a name="l00204"></a>00204 <span class="preprocessor">#define UART_PIN_FUNC( func ) INFIX( func, _, BIT )</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>
<a name="l00206"></a>00206 <span class="preprocessor">#define UART_0_LOC_1_RX_BIT 2</span>
<a name="l00207"></a>00207 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_1_TX_BIT 3</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_1_CT_BIT 4</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_1_RT_BIT 5</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span>
<a name="l00211"></a>00211 <span class="preprocessor">#define UART_0_LOC_2_CT_BIT 2</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_2_RT_BIT 3</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_2_RX_BIT 4</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span><span class="preprocessor">#define UART_0_LOC_2_TX_BIT 5</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span>
<a name="l00216"></a>00216 <span class="preprocessor">#define UART_1_LOC_1_CT_BIT 2</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_1_RT_BIT 3</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_1_TX_BIT 4</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_1_RX_BIT 5</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>
<a name="l00221"></a>00221 <span class="preprocessor">#define UART_1_LOC_2_CT_BIT 4</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_2_RT_BIT 5</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_2_TX_BIT 6</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span><span class="preprocessor">#define UART_1_LOC_2_RX_BIT 7</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">/*                 UART REGISTER AND BIT FIELD ACCESS MACROS                  */</span>
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="preprocessor">#define UART_UxCSR( uart )   INFIX( U, uart, CSR )     </span><span class="comment">/* control and status register */</span>
<a name="l00230"></a>00230 <span class="preprocessor">#define UART_MODE( uart )    INFIX( U, uart, MODE )    </span><span class="comment">/* SPI or UART mode select */</span>
<a name="l00231"></a>00231 <span class="preprocessor">#define UART_RE( uart )      INFIX( U, uart, RE )      </span><span class="comment">/* receiver enable */</span>
<a name="l00232"></a>00232 <span class="preprocessor">#define UART_FE( uart )      INFIX( U, uart, FE )      </span><span class="comment">/* framing error */</span>
<a name="l00233"></a>00233 <span class="preprocessor">#define UART_ERR( uart )     INFIX( U, uart, ERR )     </span><span class="comment">/* parity error */</span>
<a name="l00234"></a>00234 <span class="preprocessor">#define UART_RX_BYTE( uart ) INFIX( U, uart, RX_BYTE ) </span><span class="comment">/* received status */</span>
<a name="l00235"></a>00235 <span class="preprocessor">#define UART_TX_BYTE( uart ) INFIX( U, uart, TX_BYTE ) </span><span class="comment">/* transmit status */</span>
<a name="l00236"></a>00236 <span class="preprocessor">#define UART_ACTIVE( uart )  INFIX( U, uart, ACTIVE )  </span><span class="comment">/* UART busy status */</span>
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="preprocessor">#define UART_UxUCR( uart )   INFIX( U, uart, UCR )     </span><span class="comment">/* contorl register */</span>
<a name="l00239"></a>00239 <span class="preprocessor">#define UART_FLUSH( uart )   INFIX( U, uart, FLUSH )   </span><span class="comment">/* flush UART state */</span>
<a name="l00240"></a>00240 <span class="preprocessor">#define UART_FLOW( uart )    INFIX( U, uart, FLOW )    </span><span class="comment">/* flow control enable */</span>
<a name="l00241"></a>00241 <span class="preprocessor">#define UART_D9( uart )      INFIX( U, uart, D9 )      </span><span class="comment">/* data bit 9 or parity */</span>
<a name="l00242"></a>00242 <span class="preprocessor">#define UART_BIT9( uart )    INFIX( U, uart, BIT9 )    </span><span class="comment">/* 9 bit data enable */</span>
<a name="l00243"></a>00243 <span class="preprocessor">#define UART_PARITY( uart )  INFIX( U, uart, PARITY )  </span><span class="comment">/* parity enable */</span>
<a name="l00244"></a>00244 <span class="preprocessor">#define UART_SPB( uart )     INFIX( U, uart, SPB )     </span><span class="comment">/* number of stop bits */</span>
<a name="l00245"></a>00245 <span class="preprocessor">#define UART_STOP( uart )    INFIX( U, uart, STOP )    </span><span class="comment">/* stop bit polarity */</span>
<a name="l00246"></a>00246 <span class="preprocessor">#define UART_START( uart )   INFIX( U, uart, START )   </span><span class="comment">/* start bit polarity */</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="preprocessor">#define UART_UxGCR( uart )   INFIX( U, uart, GCR )     </span><span class="comment">/* generic control register */</span>
<a name="l00249"></a>00249 <span class="preprocessor">#define UART_ORDER( uart )   INFIX( U, uart, ORDER )   </span><span class="comment">/* lsb or msb first */</span>
<a name="l00250"></a>00250 <span class="preprocessor">#define UART_BAUD_E( uart )  INFIX( U, uart, BAUD_E )  </span><span class="comment">/* baud rate exponent */</span>
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="preprocessor">#define UART_UxDBUF( uart )  INFIX( U, uart, DBUF )    </span><span class="comment">/* tranciever data buffer */</span>
<a name="l00253"></a>00253 <span class="preprocessor">#define UART_UxBAUD( uart )  INFIX( U, uart, BAUD )    </span><span class="comment">/* buad rate mantissa */</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="comment">/* These macros provide access to resource allocation functions in the io registers */</span>
<a name="l00256"></a>00256 <span class="preprocessor">#define UART_UxCFG( uart )   INFIX( U, uart, CFG )</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span>
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="comment">/*            UART REGISTER AND BIT FIELD OPERATIONS MACROS                   */</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="comment">/* uart mode settings */</span>
<a name="l00263"></a>00263 <span class="preprocessor">#define UART_MODE_UART 1</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span><span class="preprocessor">#define UART_MODE_SPI  0</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span><span class="preprocessor">#define UART_MODE_SET_UART( uart ) ( UART_MODE( uart ) = UART_MODE_UART )</span>
<a name="l00266"></a>00266 <span class="preprocessor"></span>
<a name="l00267"></a>00267 <span class="comment">/* uart receiver enabled states */</span>
<a name="l00268"></a>00268 <span class="preprocessor">#define UART_RE_ENABLED  1</span>
<a name="l00269"></a>00269 <span class="preprocessor"></span><span class="preprocessor">#define UART_RE_DISABLED 0</span>
<a name="l00270"></a>00270 <span class="preprocessor"></span><span class="preprocessor">#define UART_RE_ENABLE( uart )  ( UART_RE( uart ) = UART_RE_ENABLED )</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span><span class="preprocessor">#define UART_RE_DISABLE( uart ) ( UART_RE( uart ) = UART_RE_DISABLED )</span>
<a name="l00272"></a>00272 <span class="preprocessor"></span>
<a name="l00273"></a>00273 <span class="comment">/* uart frame error status */</span>
<a name="l00274"></a>00274 <span class="preprocessor">#define UART_FE_NOERR 0</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span><span class="preprocessor">#define UART_FE_ERROR 1</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a>00277 <span class="comment">/* uart parity error status */</span>
<a name="l00278"></a>00278 <span class="preprocessor">#define UART_ERR_NOERR 0</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span><span class="preprocessor">#define UART_ERR_ERROR 1</span>
<a name="l00280"></a>00280 <span class="preprocessor"></span>
<a name="l00281"></a>00281 <span class="comment">/* uart received byte status */</span>
<a name="l00282"></a>00282 <span class="preprocessor">#define UART_RX_BYTE_RX_EMPTY 0</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor">#define UART_RX_BYTE_RX_FULL  1</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>
<a name="l00285"></a>00285 <span class="comment">/* uart transmit byte status */</span>
<a name="l00286"></a>00286 <span class="preprocessor">#define UART_TX_BYTE_TX_FULL  0</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span><span class="preprocessor">#define UART_TX_BYTE_TX_EMPTY 1</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span>
<a name="l00289"></a>00289 <span class="comment">/* uart busy status */</span>
<a name="l00290"></a>00290 <span class="preprocessor">#define UART_ACTIVE_IDLE 0</span>
<a name="l00291"></a>00291 <span class="preprocessor"></span><span class="preprocessor">#define UART_ACTIVE_BUSY 1</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>
<a name="l00293"></a>00293 <span class="comment">/* uart parity states */</span>
<a name="l00294"></a>00294 <span class="preprocessor">#define UART_PARITY_ENABLED  0</span>
<a name="l00295"></a>00295 <span class="preprocessor"></span><span class="preprocessor">#define UART_PARITY_DISABLED 1</span>
<a name="l00296"></a>00296 <span class="preprocessor"></span>
<a name="l00297"></a>00297 <span class="comment">/* uart flush the uart */</span>
<a name="l00298"></a>00298 <span class="preprocessor">#define UART_FLUSH_FLUSH_NOW 1</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span><span class="preprocessor">#define UART_FLUSH_NOW( uart ) ( UART_FLUSH( uart ) = UART_FLUSH_FLUSH_NOW )</span>
<a name="l00300"></a>00300 <span class="preprocessor"></span>
<a name="l00301"></a>00301 <span class="comment">/* uart hardware flow control options */</span>
<a name="l00302"></a>00302 <span class="preprocessor">#define UART_FLOW_CONTROL_ENABLE( uart )  ( UART_FLOW( uart ) = UART_FLOW_CONTROL_ON )</span>
<a name="l00303"></a>00303 <span class="preprocessor"></span><span class="preprocessor">#define UART_FLOW_CONTROL_DISABLE( uart ) ( UART_FLOW( uart ) = UART_FLOW_CONTROL_OFF )</span>
<a name="l00304"></a>00304 <span class="preprocessor"></span>
<a name="l00305"></a>00305 <span class="comment">/* uart bit 9 or parity states */</span>
<a name="l00306"></a>00306 <span class="preprocessor">#define UART_D9_HI          1</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span><span class="preprocessor">#define UART_D9_LO          0</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span><span class="preprocessor">#define UART_D9_EVEN_PARITY 0</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span><span class="preprocessor">#define UART_D9_ODD_PARITY  1</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span><span class="preprocessor">#define UART_SET_PARITY_EVEN( uart )       ( UART_D9( uart ) = UART_D9_EVEN_PARITY )</span>
<a name="l00311"></a>00311 <span class="preprocessor"></span><span class="preprocessor">#define UART_SET_PARITY_ODD( uart )        ( UART_D9( uart ) = UART_D9_ODD_PARITY )</span>
<a name="l00312"></a>00312 <span class="preprocessor"></span><span class="preprocessor">#define UART_SET_PARITY_MODE( uart, mode ) ( ( mode == UART_PARITY_EVEN ) \</span>
<a name="l00313"></a>00313 <span class="preprocessor">                  ? UART_SET_PARITY_EVEN( uart ) : UART_SET_PARITY_ODD( uart ) )</span>
<a name="l00314"></a>00314 <span class="preprocessor"></span>
<a name="l00315"></a>00315 <span class="comment">/* uart 8/9 bit transfer size selection */</span>
<a name="l00316"></a>00316 <span class="preprocessor">#define UART_BIT9_8_BIT_MODE  0</span>
<a name="l00317"></a>00317 <span class="preprocessor"></span><span class="preprocessor">#define UART_BIT9_9_BIT_MODE  1</span>
<a name="l00318"></a>00318 <span class="preprocessor"></span><span class="preprocessor">#define UART_BIT9_USE_PARITY  1</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span><span class="preprocessor">#define UART_BIT9_NO_PARITY   0</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span><span class="preprocessor">#define UART_BIT9_SET_9_BIT_MODE( uart ) ( UART_BIT9( uart ) = UART_BIT9_9_BIT_MODE )</span>
<a name="l00321"></a>00321 <span class="preprocessor"></span><span class="preprocessor">#define UART_BIT9_SET_8_BIT_MODE( uart ) ( UART_BIT9( uart ) = UART_BIT9_8_BIT_MODE )</span>
<a name="l00322"></a>00322 <span class="preprocessor"></span>
<a name="l00323"></a>00323 <span class="comment">/* uart parity enabled status */</span>
<a name="l00324"></a>00324 <span class="preprocessor">#define UART_PARITY_ENABLE( uart, mode )  ( UART_PARITY( uart ) = UART_PARITY_ENABLED, \</span>
<a name="l00325"></a>00325 <span class="preprocessor">                                                    UART_BIT9_SET_9_BIT_MODE( uart ),  \</span>
<a name="l00326"></a>00326 <span class="preprocessor">                                                    UART_SET_PARITY_MODE( uart, mode ) )</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span><span class="preprocessor">#define UART_PARITY_DISABLE( uart, mode ) ( UART_PARITY( uart ) = UART_PARITY_DISABLED )</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>
<a name="l00329"></a>00329 <span class="comment">/* uart number of stops bits to use */</span>
<a name="l00330"></a>00330 <span class="preprocessor">#define UART_SPB_1_STOP_BIT  UART_1_STOP_BIT</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span><span class="preprocessor">#define UART_SPB_2_STOP_BITS UART_2_STOP_BITS</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span><span class="preprocessor">#define UART_SPB_USE_1_STOP_BIT( uart )  ( UART_SPB( uart ) = UART_SPB_1_STOP_BIT )</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span><span class="preprocessor">#define UART_SPB_USE_2_STOP_BITS( uart ) ( UART_SPB( uart ) = UART_SPB_2_STOP_BITS )</span>
<a name="l00334"></a>00334 <span class="preprocessor"></span>
<a name="l00335"></a>00335 <span class="comment">/* uart stop bit polarity */</span>
<a name="l00336"></a>00336 <span class="preprocessor">#define UART_STOP_LO 0</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span><span class="preprocessor">#define UART_STOP_HI 1</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span><span class="preprocessor">#define UART_STOP_ACTIVE_LO( uart ) ( UART_STOP( uart ) = UART_STOP_LO )</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span><span class="preprocessor">#define UART_STOP_ACTIVE_HI( uart ) ( UART_STOP( uart ) = UART_STOP_HI )</span>
<a name="l00340"></a>00340 <span class="preprocessor"></span>
<a name="l00341"></a>00341 <span class="comment">/* uart start bit polarity */</span>
<a name="l00342"></a>00342 <span class="preprocessor">#define UART_START_LO 0</span>
<a name="l00343"></a>00343 <span class="preprocessor"></span><span class="preprocessor">#define UART_START_HI 1</span>
<a name="l00344"></a>00344 <span class="preprocessor"></span><span class="preprocessor">#define UART_START_ACTIVE_LO( uart ) ( UART_START( uart ) = UART_START_LO )</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span><span class="preprocessor">#define UART_START_ACTIVE_HI( uart ) ( UART_START( uart ) = UART_START_HI )</span>
<a name="l00346"></a>00346 <span class="preprocessor"></span>
<a name="l00347"></a>00347 <span class="comment">/* uart transfer order settings */</span>
<a name="l00348"></a>00348 <span class="preprocessor">#define UART_ORDER_LSB_FIRST 0</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span><span class="preprocessor">#define UART_ORDER_MSB_FIRST 1</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span><span class="preprocessor">#define UART_ORDER_SEND_LSB_FIRST( uart ) ( UART_ORDER( uart ) = UART_ORDER_LSB_FIRST )</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span><span class="preprocessor">#define UART_ORDER_SEND_MSB_FIRST( uart ) ( UART_ORDER( uart ) = UART_ORDER_MSB_FIRST )</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span>
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/*        RESOURCE ALLOCATION AND INITIALIZATION MACROS                       */</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="comment">/* set uart operations for alternate location 1 or 2 */</span>
<a name="l00358"></a>00358 <span class="preprocessor">#define UART_INIT_UxCFG( uart, loc )  ( UART_UxCFG( uart ) = loc - 1 )</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>
<a name="l00360"></a>00360 <span class="comment">/* disable any adc pins which will be used by the uart */</span>
<a name="l00361"></a>00361 <span class="preprocessor">#define UART_ADCCFGx( uart, loc, func ) CONCATENATE( ADCCFG, UART_PIN( uart, loc, func ) )</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span><span class="preprocessor">#define UART_INIT_ADCCFG( uart, loc, flow ) \</span>
<a name="l00363"></a>00363 <span class="preprocessor">                  ( ( loc != 1 ) ? ( (void) 0 ) : \</span>
<a name="l00364"></a>00364 <span class="preprocessor">                      ( (void) ( ( flow == UART_FLOW_CONTROL_OFF ) ? \</span>
<a name="l00365"></a>00365 <span class="preprocessor">                                       ( UART_ADCCFGx( uart, loc, TX ) = 0, \</span>
<a name="l00366"></a>00366 <span class="preprocessor">                                         UART_ADCCFGx( uart, loc, RX ) = 0 ) : \</span>
<a name="l00367"></a>00367 <span class="preprocessor">                                       ( UART_ADCCFGx( uart, loc, TX ) = 0, \</span>
<a name="l00368"></a>00368 <span class="preprocessor">                                         UART_ADCCFGx( uart, loc, RX ) = 0, \</span>
<a name="l00369"></a>00369 <span class="preprocessor">                                         UART_ADCCFGx( uart, loc, CT ) = 0, \</span>
<a name="l00370"></a>00370 <span class="preprocessor">                                         UART_ADCCFGx( uart, loc, RT ) = 0 ) ) ) )</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span>
<a name="l00372"></a>00372 <span class="comment">/* set appropriate io pins to peripheral function for use by the uart */</span>
<a name="l00373"></a>00373 <span class="preprocessor">#define UART_PxSEL_x( uart, loc, func ) INFIX( CONCATENATE( SELP, UART_PORT( uart, loc ) ), _, UART_PIN( uart, loc, func ) )</span>
<a name="l00374"></a>00374 <span class="preprocessor"></span><span class="preprocessor">#define UART_INIT_PxSEL( uart, loc, flow ) \</span>
<a name="l00375"></a>00375 <span class="preprocessor">                  ( ( flow == UART_FLOW_CONTROL_OFF ) ? \</span>
<a name="l00376"></a>00376 <span class="preprocessor">                                    ( UART_PxSEL_x( uart, loc, TX ) = 1, \</span>
<a name="l00377"></a>00377 <span class="preprocessor">                                      UART_PxSEL_x( uart, loc, RX ) = 1 ) : \</span>
<a name="l00378"></a>00378 <span class="preprocessor">                                    ( UART_PxSEL_x( uart, loc, TX ) = 1, \</span>
<a name="l00379"></a>00379 <span class="preprocessor">                                      UART_PxSEL_x( uart, loc, RX ) = 1, \</span>
<a name="l00380"></a>00380 <span class="preprocessor">                                      UART_PxSEL_x( uart, loc, CT ) = 1, \</span>
<a name="l00381"></a>00381 <span class="preprocessor">                                      UART_PxSEL_x( uart, loc, RT ) = 1 ) )</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span>
<a name="l00383"></a>00383 <span class="comment">/* set priority of uart over other peripherals, assumes current uart being</span>
<a name="l00384"></a>00384 <span class="comment"> * configured has priority over the other uart whether or not it is configured */</span>
<a name="l00385"></a>00385 <span class="preprocessor">#define UART_INIT_PRIxPx( uart, loc ) ( ( loc != 1 ) \</span>
<a name="l00386"></a>00386 <span class="preprocessor">                    ? PRIP0 = uart : ( PRI3P1 = uart, PRI2P1 = 0, PRI0P1 = 0 ) )</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span>
<a name="l00388"></a>00388 <span class="comment">/* set flow control */</span>
<a name="l00389"></a>00389 <span class="preprocessor">#define UART_INIT_FLOW_CONTROL( uart, flow ) \</span>
<a name="l00390"></a>00390 <span class="preprocessor">    ( ( flow == UART_FLOW_CONTROL_OFF ) \</span>
<a name="l00391"></a>00391 <span class="preprocessor">        ? UART_FLOW_CONTROL_DISABLE( uart ) : UART_FLOW_CONTROL_ENABLE( uart ) )</span>
<a name="l00392"></a>00392 <span class="preprocessor"></span>
<a name="l00393"></a>00393 <span class="comment">/* set parity */</span>
<a name="l00394"></a>00394 <span class="preprocessor">#define UART_INIT_PARITY( uart, parity ) ( ( parity == UART_PARITY_NONE ) \</span>
<a name="l00395"></a>00395 <span class="preprocessor">        ? UART_PARITY_DISABLE( uart, parity ) : UART_PARITY_ENABLE( uart, parity ) )</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span><span class="comment">//( ( parity == UART_PARITY_ENABLED ) \</span>
<a name="l00397"></a>00397 <span class="comment">                    ? UART_PARITY_ENABLE( uart ) : UART_PARITY_DISABLE( uart ) )</span>
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">/* set number of stop bits */</span>
<a name="l00400"></a>00400 <span class="preprocessor">#define UART_INIT_SPB( uart, spb ) ( ( spb == UART_SPB_1_STOP_BIT ) \</span>
<a name="l00401"></a>00401 <span class="preprocessor">          ? UART_SPB_USE_1_STOP_BIT( uart ) : UART_SPB_USE_2_STOP_BITS( uart ) )</span>
<a name="l00402"></a>00402 <span class="preprocessor"></span>
<a name="l00403"></a>00403 <span class="comment">/* set stop bit(s) polarity */</span>
<a name="l00404"></a>00404 <span class="preprocessor">#define UART_INIT_STOP( uart, stop ) ( ( stop == UART_STOP_LO ) \</span>
<a name="l00405"></a>00405 <span class="preprocessor">                   ? UART_STOP_ACTIVE_LO( uart ) : UART_STOP_ACTIVE_HI( uart ) )</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span>
<a name="l00407"></a>00407 <span class="comment">/* set start bit polarity */</span>
<a name="l00408"></a>00408 <span class="preprocessor">#define UART_INIT_START( uart, start ) ( ( start == UART_START_LO ) \</span>
<a name="l00409"></a>00409 <span class="preprocessor">                 ? UART_START_ACTIVE_LO( uart ) : UART_START_ACTIVE_HI( uart ) )</span>
<a name="l00410"></a>00410 <span class="preprocessor"></span>
<a name="l00411"></a>00411 <span class="comment">/* set transfer bit order */</span>
<a name="l00412"></a>00412 <span class="preprocessor">#define UART_INIT_ORDER( uart, order ) ( ( order == UART_ORDER_LSB_FIRST ) \</span>
<a name="l00413"></a>00413 <span class="preprocessor">       ? UART_ORDER_SEND_LSB_FIRST( uart ) : UART_ORDER_SEND_MSB_FIRST( uart ) )</span>
<a name="l00414"></a>00414 <span class="preprocessor"></span>
<a name="l00415"></a>00415 <span class="comment">/* set baud rate... */</span>
<a name="l00416"></a>00416 <span class="comment">/*</span>
<a name="l00417"></a>00417 <span class="comment">The equation from the data sheets for the CC2430, CC2510, and CC1110 is</span>
<a name="l00418"></a>00418 <span class="comment"></span>
<a name="l00419"></a>00419 <span class="comment">                      baud_e</span>
<a name="l00420"></a>00420 <span class="comment">   (256 + baud_m) * 2</span>
<a name="l00421"></a>00421 <span class="comment">  --------------------------- * fref == baud_rate</span>
<a name="l00422"></a>00422 <span class="comment">                28</span>
<a name="l00423"></a>00423 <span class="comment">              2</span>
<a name="l00424"></a>00424 <span class="comment"></span>
<a name="l00425"></a>00425 <span class="comment">Knowing that the maximum value for the baud_m register is 255, we can</span>
<a name="l00426"></a>00426 <span class="comment">create a table using that value and the reference clock rate to determine</span>
<a name="l00427"></a>00427 <span class="comment">where the baud_e cutoff buad rates are at.  For example, if we plug 32MHz in</span>
<a name="l00428"></a>00428 <span class="comment">for fref, 255 in for baud_m, and the values 0 through 15 in for baud_e then</span>
<a name="l00429"></a>00429 <span class="comment">we get the following table of values</span>
<a name="l00430"></a>00430 <span class="comment"></span>
<a name="l00431"></a>00431 <span class="comment">        | maximum</span>
<a name="l00432"></a>00432 <span class="comment">baud_e  | achievable</span>
<a name="l00433"></a>00433 <span class="comment">setting | baud rate</span>
<a name="l00434"></a>00434 <span class="comment">--------+------------</span>
<a name="l00435"></a>00435 <span class="comment">    0   |       60</span>
<a name="l00436"></a>00436 <span class="comment">    1   |      121</span>
<a name="l00437"></a>00437 <span class="comment">    2   |      243</span>
<a name="l00438"></a>00438 <span class="comment">    3   |      487</span>
<a name="l00439"></a>00439 <span class="comment">    4   |      974</span>
<a name="l00440"></a>00440 <span class="comment">    5   |     1949</span>
<a name="l00441"></a>00441 <span class="comment">    6   |     3898</span>
<a name="l00442"></a>00442 <span class="comment">    7   |     7797</span>
<a name="l00443"></a>00443 <span class="comment">    8   |    15594</span>
<a name="l00444"></a>00444 <span class="comment">    9   |    31188</span>
<a name="l00445"></a>00445 <span class="comment">   10   |    62377</span>
<a name="l00446"></a>00446 <span class="comment">   11   |   124755</span>
<a name="l00447"></a>00447 <span class="comment">   12   |   249511</span>
<a name="l00448"></a>00448 <span class="comment">   13   |   499023</span>
<a name="l00449"></a>00449 <span class="comment">   14   |   998046</span>
<a name="l00450"></a>00450 <span class="comment">   15   |  1996093</span>
<a name="l00451"></a>00451 <span class="comment"></span>
<a name="l00452"></a>00452 <span class="comment">Thus we can use the spec sheet formula to calculate baud_e values based on the</span>
<a name="l00453"></a>00453 <span class="comment">baud rate requested and the system clock frequency.</span>
<a name="l00454"></a>00454 <span class="comment"></span>
<a name="l00455"></a>00455 <span class="comment">Note: there is a little bit of fixed point optimization in the following</span>
<a name="l00456"></a>00456 <span class="comment">      formula to manage overflow issues.</span>
<a name="l00457"></a>00457 <span class="comment">*/</span>
<a name="l00458"></a>00458 <span class="preprocessor">#define UART_CALC_BAUD_E_CUTOFF( n ) \</span>
<a name="l00459"></a>00459 <span class="preprocessor">         ( ( ( 511ul * UART_CLOCK_MHZ * 15625ul ) &gt;&gt; ( 22 - n ) ) + 1 )</span>
<a name="l00460"></a>00460 <span class="preprocessor"></span><span class="preprocessor">#define UART_BAUD_CAST( baud ) ( (unsigned long) baud )</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span><span class="preprocessor">#define UART_CALC_BAUD_E( baud )      \</span>
<a name="l00462"></a>00462 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  0 ) ) ?  0 : \</span>
<a name="l00463"></a>00463 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  1 ) ) ?  1 : \</span>
<a name="l00464"></a>00464 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  2 ) ) ?  2 : \</span>
<a name="l00465"></a>00465 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  3 ) ) ?  3 : \</span>
<a name="l00466"></a>00466 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  4 ) ) ?  4 : \</span>
<a name="l00467"></a>00467 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  5 ) ) ?  5 : \</span>
<a name="l00468"></a>00468 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  6 ) ) ?  6 : \</span>
<a name="l00469"></a>00469 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  7 ) ) ?  7 : \</span>
<a name="l00470"></a>00470 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  8 ) ) ?  8 : \</span>
<a name="l00471"></a>00471 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF(  9 ) ) ?  9 : \</span>
<a name="l00472"></a>00472 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 10 ) ) ? 10 : \</span>
<a name="l00473"></a>00473 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 11 ) ) ? 11 : \</span>
<a name="l00474"></a>00474 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 12 ) ) ? 12 : \</span>
<a name="l00475"></a>00475 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 13 ) ) ? 13 : \</span>
<a name="l00476"></a>00476 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 14 ) ) ? 14 : \</span>
<a name="l00477"></a>00477 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 15 ) ) ? 15 : \</span>
<a name="l00478"></a>00478 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 16 ) ) ? 16 : \</span>
<a name="l00479"></a>00479 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 17 ) ) ? 17 : \</span>
<a name="l00480"></a>00480 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 18 ) ) ? 18 : \</span>
<a name="l00481"></a>00481 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 19 ) ) ? 19 : \</span>
<a name="l00482"></a>00482 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 20 ) ) ? 20 : \</span>
<a name="l00483"></a>00483 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 21 ) ) ? 21 : \</span>
<a name="l00484"></a>00484 <span class="preprocessor">         ( ( baud &lt; UART_CALC_BAUD_E_CUTOFF( 22 ) ) ? 22 : \</span>
<a name="l00485"></a>00485 <span class="preprocessor">             23 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )</span>
<a name="l00486"></a>00486 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00487"></a>00487 <span class="comment">Now that we know what the value we need for the baud_e setting, we can use</span>
<a name="l00488"></a>00488 <span class="comment">that knowledge and solve the original formula for the baud_m setting resulting</span>
<a name="l00489"></a>00489 <span class="comment">in the following</span>
<a name="l00490"></a>00490 <span class="comment"></span>
<a name="l00491"></a>00491 <span class="comment">                    28     baud_e</span>
<a name="l00492"></a>00492 <span class="comment">                  2    * 2        * baud</span>
<a name="l00493"></a>00493 <span class="comment">baud_m == -256 + ------------------------</span>
<a name="l00494"></a>00494 <span class="comment">                           fref</span>
<a name="l00495"></a>00495 <span class="comment"></span>
<a name="l00496"></a>00496 <span class="comment">Again, a little fixed point optimization and rounding results in</span>
<a name="l00497"></a>00497 <span class="comment">*/</span>
<a name="l00498"></a>00498 <span class="preprocessor">#define UART_CALC_BAUD_M( baud ) \</span>
<a name="l00499"></a>00499 <span class="preprocessor">                           ( ( ( ( baud &lt;&lt; ( 23 - UART_CALC_BAUD_E( baud ) ) ) \</span>
<a name="l00500"></a>00500 <span class="preprocessor">                                 / 15625ul / UART_CLOCK_MHZ + 1 ) &gt;&gt; 1 ) - 256 )</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span><span class="preprocessor">#define UART_INIT_BAUD( uart, baud ) \</span>
<a name="l00502"></a>00502 <span class="preprocessor">           ( UART_BAUD_E( uart ) = UART_CALC_BAUD_E( UART_BAUD_CAST( baud ) ), \</span>
<a name="l00503"></a>00503 <span class="preprocessor">             UART_UxBAUD( uart ) = UART_CALC_BAUD_M( UART_BAUD_CAST( baud ) ) )</span>
<a name="l00504"></a>00504 <span class="preprocessor"></span>
<a name="l00505"></a>00505 <span class="comment">/* initialize all aspects of a uart according to the parameters passed</span>
<a name="l00506"></a>00506 <span class="comment"> * assumes data is always 8 bits, no 9 bit support is supplied in this macro</span>
<a name="l00507"></a>00507 <span class="comment"> * also the receiver is enabled, no support for transmit only in this macro */</span>
<a name="l00508"></a>00508 <span class="preprocessor">#define UART_INIT_8051( uart, loc, flow, parity, spb, stop, start, order, baud ) \</span>
<a name="l00509"></a>00509 <span class="preprocessor">  ( UART_MODE_SET_UART( uart ),           UART_RE_ENABLE( uart ),                \</span>
<a name="l00510"></a>00510 <span class="preprocessor">    UART_INIT_UxCFG( uart, loc ),         UART_INIT_ADCCFG( uart, loc, flow ),   \</span>
<a name="l00511"></a>00511 <span class="preprocessor">    UART_INIT_PxSEL( uart, loc, flow ),   UART_INIT_PRIxPx( uart, loc ),         \</span>
<a name="l00512"></a>00512 <span class="preprocessor">    UART_INIT_FLOW_CONTROL( uart, flow ), UART_INIT_PARITY( uart, parity ),      \</span>
<a name="l00513"></a>00513 <span class="preprocessor">    UART_INIT_SPB( uart, spb ),           UART_INIT_STOP( uart, stop ),          \</span>
<a name="l00514"></a>00514 <span class="preprocessor">    UART_INIT_START( uart, start ),       UART_INIT_ORDER( uart, order ),        \</span>
<a name="l00515"></a>00515 <span class="preprocessor">    UART_INIT_BAUD( uart, baud ),         UART_FLUSH_NOW( uart ) )</span>
<a name="l00516"></a>00516 <span class="preprocessor"></span>
<a name="l00517"></a>00517 <span class="comment">/* sanity check */</span>
<a name="l00518"></a>00518 <span class="comment">/*</span>
<a name="l00519"></a>00519 <span class="comment">#if !( defined UART_NUMBER )</span>
<a name="l00520"></a>00520 <span class="comment">    || !( defined UART_LOCATION )</span>
<a name="l00521"></a>00521 <span class="comment">#error &quot;The macros UART_NUMBER and UART_LOCATION must be defined for 8051 processors.&quot;</span>
<a name="l00522"></a>00522 <span class="comment">#endif*/</span>
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 <span class="comment">/* generalized uart interface */</span>
<a name="l00525"></a>00525 <span class="preprocessor">#define UART_INIT( uart, loc, flow, parity, stop, baud )                                  \</span>
<a name="l00526"></a>00526 <span class="preprocessor">               UART_INIT_8051( uart, loc, flow, parity, stop, \</span>
<a name="l00527"></a>00527 <span class="preprocessor">                       UART_STOP_HI, UART_START_LO, UART_ORDER_LSB_FIRST, baud )</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span>
<a name="l00529"></a>00529 <span class="preprocessor">#define UART_IRQ_FLAG_CLR( uart, loc, func )  ( UART_IRQ_FLAG( uart, func ) = UART_IRQ_IDLE )</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span><span class="preprocessor">#define UART_IRQ_FLAG_SET( uart, loc, func )  ( UART_IRQ_FLAG( uart, func ) = UART_IRQ_PENDING )</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span>
<a name="l00532"></a>00532 <span class="preprocessor">#define UART_SEND( uart, loc, c ) ( UART_UxDBUF( uart ) = c )</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span><span class="preprocessor">#define UART_RECEIVE( uart, loc ) UART_UxDBUF( uart )</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span>
<a name="l00535"></a>00535 <span class="preprocessor">#endif </span><span class="comment">/* defined ( __IAR_SYSTEMS_ICC__ &amp;&amp; __ICC430__ &amp;&amp; BSP_BOARD_SRF05EB ) */</span>
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="comment">/* ------------------------------------------------------------------------------------------------</span>
<a name="l00545"></a>00545 <span class="comment"> *                                Typedefs</span>
<a name="l00546"></a>00546 <span class="comment"> * ------------------------------------------------------------------------------------------------</span>
<a name="l00547"></a>00547 <span class="comment"> */</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 <span class="comment">/* this type represents a function to call for each data character being</span>
<a name="l00550"></a>00550 <span class="comment"> * transmitted across the uart.  it will be called at the character data rate.</span>
<a name="l00551"></a>00551 <span class="comment"> * the user should return true if there are still more characters to send and</span>
<a name="l00552"></a>00552 <span class="comment"> * false if this is the last character to send.  the character to send should</span>
<a name="l00553"></a>00553 <span class="comment"> * be placed at the position pointed to by the passed parameter */</span>
<a name="l00554"></a><a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">00554</a> <span class="keyword">typedef</span> bool ( *<a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> )( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* );
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="comment">/* this type represents a function to call for each data character that is</span>
<a name="l00557"></a>00557 <span class="comment"> * received from the uart.  it will be called at the character data rate.</span>
<a name="l00558"></a>00558 <span class="comment"> * the character recieved is passed as the parameter to the function.</span>
<a name="l00559"></a>00559 <span class="comment"> * the user should return true if it is willing to accept more data, a return</span>
<a name="l00560"></a>00560 <span class="comment"> * value of false indicates the user is closing this message and no longer</span>
<a name="l00561"></a>00561 <span class="comment"> * wants to accept data from the uart. */</span>
<a name="l00562"></a><a class="code" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">00562</a> <span class="keyword">typedef</span> bool ( *<a class="code" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a> )( <span class="keywordtype">unsigned</span> char );
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">/* ------------------------------------------------------------------------------------------------</span>
<a name="l00566"></a>00566 <span class="comment"> *                                Function Prototypes</span>
<a name="l00567"></a>00567 <span class="comment"> * ------------------------------------------------------------------------------------------------</span>
<a name="l00568"></a>00568 <span class="comment"> */</span>
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">/* initializes the uart for operation.  this function should be called before</span>
<a name="l00571"></a>00571 <span class="comment"> * any other uart functions are called. */</span>
<a name="l00572"></a>00572 <span class="keywordtype">void</span> <a class="code" href="uart_8c.html#a0c0ca72359ddf28dcd15900dfba19343">uart_init</a>( <span class="keywordtype">void</span> );
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="comment">/* attempts to begin a uart transmission.  if &lt;handler&gt; is NULL or there is</span>
<a name="l00575"></a>00575 <span class="comment"> * currently another message being sent, false is returned.  otherwise, true</span>
<a name="l00576"></a>00576 <span class="comment"> * is returned indicating the message will be sent immediately.</span>
<a name="l00577"></a>00577 <span class="comment"> * the handler passed must be able to respond to character by character</span>
<a name="l00578"></a>00578 <span class="comment"> * requests from the isr.  see the description of uart_get_tx_data_type above</span>
<a name="l00579"></a>00579 <span class="comment"> * for more details. */</span>
<a name="l00580"></a>00580 <span class="keywordtype">bool</span> <a class="code" href="uart_8c.html#ac21e32f744f91b62d39dc91d9b9a498c">uart1_tx_message</a>( <a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler );
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="comment">/* attempts to begin a uart reception.  if &lt;handler&gt; is NULL or there is</span>
<a name="l00583"></a>00583 <span class="comment"> * currently another message being received, false is returned.  otherwise,</span>
<a name="l00584"></a>00584 <span class="comment"> * true is returned indicating the handler has been accepted for any new</span>
<a name="l00585"></a>00585 <span class="comment"> * data received.  the handler passed must be able to respond to character by</span>
<a name="l00586"></a>00586 <span class="comment"> * character requests from the isr.  see the description of</span>
<a name="l00587"></a>00587 <span class="comment"> * uart_put_rx_data_type above for more details. */</span>
<a name="l00588"></a>00588 <span class="keywordtype">bool</span> <a class="code" href="uart_8c.html#a3a82624c239e46cd58090fef851d8a44">uart_rx_message</a>( <a class="code" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a> handler );
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="keywordtype">bool</span> <a class="code" href="uart_8c.html#a445848debe88e89b5d22dea2f6a18ca1">uart0_tx_message</a>( <a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler );
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <span class="preprocessor">#endif </span><span class="comment">/* uart_h */</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="uart_8h.html">uart.h</a>      </li>
      <li class="footer">Generated on Sat Apr 30 2011 08:30:24 for Embedded GarageBand by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
