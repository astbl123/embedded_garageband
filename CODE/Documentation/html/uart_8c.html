<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded GarageBand: uart.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Picture1.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded GarageBand&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The project is aimed at developing an embedded Garage band that uses an 8051 microcontroller. The user can access the instruments via the touchscreen+graphics LCD or use the instruments that we have constructed. In this document we will cover the complete detail of the project including its construction, hardware design, software design and debugging.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('uart_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">uart.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="uart_8h_source.html">uart.h</a>&quot;</code><br/>
</div>
<p><a href="uart_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#ae5d3e153a7ab7a21adfa45b61c2cfb51">uart1_tx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a0f8f3cf3982ce7023c33b85076bfafb3">uart_rx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a8688eebcf4dc6c84d83af96ce17a4a87">uart0_tx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__idata_reentrant __interrupt void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a1fee6c94689824d31b2108474bd11d0a">uart_0_tx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__idata_reentrant __interrupt void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a7f8db49a8c8d4855ac69c4e1b28e2c60">uart_1_tx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__idata_reentrant __interrupt void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#acafe1d304d9f2c4ba25aa72af98ea356">uart_0_rx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__idata_reentrant __interrupt void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a42ba22950331df3af631c6ed94984aad">uart_1_rx_irq</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a0c0ca72359ddf28dcd15900dfba19343">uart_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#ac21e32f744f91b62d39dc91d9b9a498c">uart1_tx_message</a> (<a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a3a82624c239e46cd58090fef851d8a44">uart_rx_message</a> (<a class="el" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a> handler)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a445848debe88e89b5d22dea2f6a18ca1">uart0_tx_message</a> (<a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> = NULL</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8688eebcf4dc6c84d83af96ce17a4a87"></a><!-- doxytag: member="uart.c::uart0_tx_irq" ref="a8688eebcf4dc6c84d83af96ce17a4a87" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart0_tx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00321">321</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;
  <a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler;

  <a class="code" href="uart_8h.html#af2a42700803cd5bf6844980aed5da0e1">BSP_CRITICAL_STATEMENT</a>( handler = <a class="code" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> );

  <span class="comment">/* if a handler exists */</span>
  <span class="keywordflow">if</span>( handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
    {
    <span class="keywordflow">if</span>( (*handler)( &amp;c ) != <span class="keyword">false</span> ) <span class="comment">/* if this is not the last byte to send */</span>
      {
      <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a> intState;
      <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( intState );

      <span class="comment">/* only reset the interrupt flag if we have additional data to send</span>
<span class="comment">       * that way, if we are done then the interrupt is still pending and</span>
<span class="comment">       * will be immediately entered upon re-enabling it.*/</span>
      UART_IRQ_FLAG_CLR( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, TX ); <span class="comment">/* eset the interrupt */</span>

      <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( intState );
      }
    <span class="keywordflow">else</span>
      {
      <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a> intState;
      <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( intState );

      <span class="comment">/* we&#39;re done sending data.  since we left the interrupt pending,</span>
<span class="comment">       * disable it so we don&#39;t re-enter the isr.  the interrupt will be</span>
<span class="comment">       * re-enabled when there is another message to send. */</span>
      UART_IRQ_DISABLE( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, TX );

      <span class="comment">/* no more data to send, reset the handler to flag not busy */</span>
      <a class="code" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

      <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( intState );
      }

    UART_SEND( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, c ); <span class="comment">/* send the byte */</span>
    }
  <span class="keywordflow">else</span> <span class="comment">/* if no handler exists?!?!?!? */</span>
    <span class="comment">/* something went wrong, disable interrupts so we don&#39;t get stuck here */</span>
    UART_IRQ_DISABLE( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, TX );

  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a445848debe88e89b5d22dea2f6a18ca1"></a><!-- doxytag: member="uart.c::uart0_tx_message" ref="a445848debe88e89b5d22dea2f6a18ca1" args="(uart_get_tx_data_type handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool uart0_tx_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a>&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00382">382</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a>  intState;
  <span class="keywordtype">bool</span> status = <span class="keyword">false</span>; <span class="comment">/* assume failure initially */</span>

  <span class="comment">/* updates required, store interrupt state and disable interrupts */</span>
  <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>(intState);

  <span class="comment">/* if no message is currently being sent and handler looks valid */</span>
  <span class="keywordflow">if</span>( <a class="code" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> == <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
    {
    <a class="code" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> = handler; <span class="comment">/* install the handler */</span>

    <span class="comment">/* once the handler has been setup, enable the interrupt.</span>
<span class="comment">     * this will cause the message to begin transmission */</span>
    UART_IRQ_ENABLE( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, TX );

    status = <span class="keyword">true</span>; <span class="comment">/* indicate success */</span>
    }

  <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>(intState); <span class="comment">/* restore interrupt state */</span>

  <span class="keywordflow">return</span> status; <span class="comment">/* indicate status */</span>
  }
</pre></div>
</div>
</div>
<a class="anchor" id="ae5d3e153a7ab7a21adfa45b61c2cfb51"></a><!-- doxytag: member="uart.c::uart1_tx_irq" ref="ae5d3e153a7ab7a21adfa45b61c2cfb51" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart1_tx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00104">104</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;
  <a class="code" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> handler;

  <a class="code" href="uart_8h.html#af2a42700803cd5bf6844980aed5da0e1">BSP_CRITICAL_STATEMENT</a>( handler = <a class="code" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> );

  <span class="comment">/* if a handler exists */</span>
  <span class="keywordflow">if</span>( handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
    {
    <span class="keywordflow">if</span>( (*handler)( &amp;c ) != <span class="keyword">false</span> ) <span class="comment">/* if this is not the last byte to send */</span>
      {
      <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a> intState;
      <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( intState );

      <span class="comment">/* only reset the interrupt flag if we have additional data to send</span>
<span class="comment">       * that way, if we are done then the interrupt is still pending and</span>
<span class="comment">       * will be immediately entered upon re-enabling it.*/</span>
      UART_IRQ_FLAG_CLR( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, TX ); <span class="comment">/* eset the interrupt */</span>

      <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( intState );
      }
    <span class="keywordflow">else</span>
      {
      <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a> intState;
      <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( intState );

      <span class="comment">/* we&#39;re done sending data.  since we left the interrupt pending,</span>
<span class="comment">       * disable it so we don&#39;t re-enter the isr.  the interrupt will be</span>
<span class="comment">       * re-enabled when there is another message to send. */</span>
      UART_IRQ_DISABLE( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, TX );

      <span class="comment">/* no more data to send, reset the handler to flag not busy */</span>
      <a class="code" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

      <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( intState );
      }

    UART_SEND( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, c ); <span class="comment">/* send the byte */</span>
    }
  <span class="keywordflow">else</span> <span class="comment">/* if no handler exists?!?!?!? */</span>
    <span class="comment">/* something went wrong, disable interrupts so we don&#39;t get stuck here */</span>
    UART_IRQ_DISABLE( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, TX );

  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac21e32f744f91b62d39dc91d9b9a498c"></a><!-- doxytag: member="uart.c::uart1_tx_message" ref="ac21e32f744f91b62d39dc91d9b9a498c" args="(uart_get_tx_data_type handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool uart1_tx_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a>&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00251">251</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a>  intState;
  <span class="keywordtype">bool</span> status = <span class="keyword">false</span>; <span class="comment">/* assume failure initially */</span>

  <span class="comment">/* updates required, store interrupt state and disable interrupts */</span>
  <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>(intState);

  <span class="comment">/* if no message is currently being sent and handler looks valid */</span>
  <span class="keywordflow">if</span>( <a class="code" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> == <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
    {
    <a class="code" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> = handler; <span class="comment">/* install the handler */</span>

    <span class="comment">/* once the handler has been setup, enable the interrupt.</span>
<span class="comment">     * this will cause the message to begin transmission */</span>
    UART_IRQ_ENABLE( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, TX );

    status = <span class="keyword">true</span>; <span class="comment">/* indicate success */</span>
    }

  <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>(intState); <span class="comment">/* restore interrupt state */</span>

  <span class="keywordflow">return</span> status; <span class="comment">/* indicate status */</span>
  }
</pre></div>
</div>
</div>
<a class="anchor" id="acafe1d304d9f2c4ba25aa72af98ea356"></a><!-- doxytag: member="uart.c::uart_0_rx_irq" ref="acafe1d304d9f2c4ba25aa72af98ea356" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__idata_reentrant __interrupt void uart_0_rx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00072">72</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="uart_8c.html#a0f8f3cf3982ce7023c33b85076bfafb3">uart_rx_irq</a>( );
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1fee6c94689824d31b2108474bd11d0a"></a><!-- doxytag: member="uart.c::uart_0_tx_irq" ref="a1fee6c94689824d31b2108474bd11d0a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__idata_reentrant __interrupt void uart_0_tx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00054">54</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="uart_8c.html#a8688eebcf4dc6c84d83af96ce17a4a87">uart0_tx_irq</a>( );
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a42ba22950331df3af631c6ed94984aad"></a><!-- doxytag: member="uart.c::uart_1_rx_irq" ref="a42ba22950331df3af631c6ed94984aad" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__idata_reentrant __interrupt void uart_1_rx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00081">81</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="uart_8c.html#a0f8f3cf3982ce7023c33b85076bfafb3">uart_rx_irq</a>( );
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f8db49a8c8d4855ac69c4e1b28e2c60"></a><!-- doxytag: member="uart.c::uart_1_tx_irq" ref="a7f8db49a8c8d4855ac69c4e1b28e2c60" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__idata_reentrant __interrupt void uart_1_tx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00063">63</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="uart_8c.html#ae5d3e153a7ab7a21adfa45b61c2cfb51">uart1_tx_irq</a>( );
  <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0c0ca72359ddf28dcd15900dfba19343"></a><!-- doxytag: member="uart.c::uart_init" ref="a0c0ca72359ddf28dcd15900dfba19343" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00194">194</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;

  <span class="comment">/* make sure the handler functions are cleared in case we are re-initialized */</span>
  <a class="code" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <a class="code" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
  <a class="code" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

  <span class="comment">/* initialize the uart interface for operations */</span>
  UART_INIT( UART_NUMBER_1,
             UART_LOCATION_2,
             <a class="code" href="uart_8h.html#a1db1457c1ec401a81da0c7d2dae88607">UART_FLOW_CONTROL</a>,    <span class="comment">/* enable/disable flow control */</span>
             <a class="code" href="uart_8h.html#a82edc7fac3f5bbdd56b34f890885bb7b">UART_PARITY_MODE</a>,     <span class="comment">/* enable/disable parity */</span>
             <a class="code" href="uart_8h.html#a5a50a502408c7bea025124b526ca381c">UART_STOP_BITS</a>,       <span class="comment">/* number of stop bits */</span>
             <a class="code" href="uart_8h.html#a9715f79cf910e2d5d89d0bd4eba81831">UART1_BAUD_RATE</a> );     <span class="comment">/* baud rate to use */</span>

  i = <a class="code" href="uart_8h.html#a9715f79cf910e2d5d89d0bd4eba81831">UART1_BAUD_RATE</a> &gt;&gt; 5; <span class="comment">/* delay approximately 1 bit time */</span>
  <span class="keywordflow">while</span>( --i != 0 ) <span class="comment">/* give the uart some time to initialize */</span>
      ; <span class="comment">/* null statement */</span>

  <span class="comment">/* set the interrupt flag so that a transmit interrupt will be pending</span>
<span class="comment">   * that way when a message is sent and the irq is enabled, the interrupt</span>
<span class="comment">   * will happen immediately to start the transmission */</span>
  UART_IRQ_FLAG_SET( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, TX ); <span class="comment">/* set the interrupt */</span>

  <span class="comment">/* enable receive interrupts, they are always welcome. */</span>
  UART_IRQ_ENABLE( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a>, RX );

  <span class="comment">/* initialize the uart interface for operations */</span>
  UART_INIT( UART_NUMBER_0,
             UART_LOCATION_2,
             <a class="code" href="uart_8h.html#a1db1457c1ec401a81da0c7d2dae88607">UART_FLOW_CONTROL</a>,    <span class="comment">/* enable/disable flow control */</span>
             <a class="code" href="uart_8h.html#a82edc7fac3f5bbdd56b34f890885bb7b">UART_PARITY_MODE</a>,     <span class="comment">/* enable/disable parity */</span>
             <a class="code" href="uart_8h.html#a5a50a502408c7bea025124b526ca381c">UART_STOP_BITS</a>,       <span class="comment">/* number of stop bits */</span>
             <a class="code" href="uart_8h.html#ade8f2cab3a291c17f2c82046c7dd50b0">UART0_BAUD_RATE</a> );     <span class="comment">/* baud rate to use */</span>

  UART_IRQ_FLAG_SET( UART_NUMBER_0, <a class="code" href="uart_8h.html#a6f8fd3cc4d1199f6fe96c08c9fc46704">UART0_LOCATION</a>, TX ); <span class="comment">/* set the interrupt */</span>

  UART_IRQ_DISABLE(UART_NUMBER_0,UART_LOCATION_2,RX);

  <span class="keywordflow">return</span>;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a0f8f3cf3982ce7023c33b85076bfafb3"></a><!-- doxytag: member="uart.c::uart_rx_irq" ref="a0f8f3cf3982ce7023c33b85076bfafb3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uart_rx_irq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00162">162</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <a class="code" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a> handler;

  <span class="comment">/* read in the received data, this will clear the interrupt also */</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c = UART_RECEIVE( UART_NUMBER_1, <a class="code" href="uart_8h.html#a1d0b3d97829ca45b38aae56795aa8bab">UART1_LOCATION</a> );

  <a class="code" href="uart_8h.html#af2a42700803cd5bf6844980aed5da0e1">BSP_CRITICAL_STATEMENT</a>( handler = <a class="code" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> );

  <span class="keywordflow">if</span>( handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) <span class="comment">/* if a handler exists to receive data */</span>
    <span class="keywordflow">if</span>( ( *handler)( c ) == <span class="keyword">false</span> ) <span class="comment">/* if the user is done receiveing */</span>
      <span class="comment">/* indicate the receiver is available */</span>
      <a class="code" href="uart_8h.html#af2a42700803cd5bf6844980aed5da0e1">BSP_CRITICAL_STATEMENT</a>( <a class="code" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> = <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> );

  <span class="keywordflow">return</span>;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a3a82624c239e46cd58090fef851d8a44"></a><!-- doxytag: member="uart.c::uart_rx_message" ref="a3a82624c239e46cd58090fef851d8a44" args="(uart_put_rx_data_type handler)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool uart_rx_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a>&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00289">289</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>
<div class="fragment"><pre class="fragment">  {
  <a class="code" href="uart_8h.html#ad45ed2a3e324170701c79dca25f0bbc9">bspIState_t</a> intState;
  <span class="keywordtype">bool</span> status = <span class="keyword">false</span>;  <span class="comment">/* assume failure initially */</span>

  <span class="comment">/* updates required, store interrupt state and disable interrupts */</span>
  <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>(intState);

  <span class="comment">/* if no message is being received and the handler looks valid */</span>
  <span class="keywordflow">if</span>( <a class="code" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> == <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; handler != <a class="code" href="hal__defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )
    {
    <a class="code" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> = handler; <span class="comment">/* install the handler */</span>

    status = <span class="keyword">true</span>; <span class="comment">/* indicate success */</span>
    }

  <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>(intState); <span class="comment">/* restore interrupt state */</span>

  <span class="keywordflow">return</span> status; <span class="comment">/* indicate status */</span>
  }
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afb05491b28329a2e45bd500524a5837c"></a><!-- doxytag: member="uart.c::uart0_tx_handler" ref="afb05491b28329a2e45bd500524a5837c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> <a class="el" href="uart_8c.html#afb05491b28329a2e45bd500524a5837c">uart0_tx_handler</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00035">35</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>

</div>
</div>
<a class="anchor" id="a514072d73232d5179848570638c70a21"></a><!-- doxytag: member="uart.c::uart1_tx_handler" ref="a514072d73232d5179848570638c70a21" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="uart_8h.html#af0b772b8349008406113fb7035df62f8">uart_get_tx_data_type</a> <a class="el" href="uart_8c.html#a514072d73232d5179848570638c70a21">uart1_tx_handler</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00034">34</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>

</div>
</div>
<a class="anchor" id="aab49171d33533ac4fdb797f44c901d29"></a><!-- doxytag: member="uart.c::uart_rx_handler" ref="aab49171d33533ac4fdb797f44c901d29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="uart_8h.html#a28157fc7a173fc91dc387b37d46ddfc2">uart_put_rx_data_type</a> <a class="el" href="uart_8c.html#aab49171d33533ac4fdb797f44c901d29">uart_rx_handler</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="uart_8c_source.html#l00036">36</a> of file <a class="el" href="uart_8c_source.html">uart.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="uart_8c.html">uart.c</a>      </li>
      <li class="footer">Generated on Sat Apr 30 2011 08:30:26 for Embedded GarageBand by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
