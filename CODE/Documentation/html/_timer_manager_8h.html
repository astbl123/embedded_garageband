<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded GarageBand: TimerManager.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Picture1.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded GarageBand&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The project is aimed at developing an embedded Garage band that uses an 8051 microcontroller. The user can access the instruments via the touchscreen+graphics LCD or use the instruments that we have constructed. In this document we will cover the complete detail of the project including its construction, hardware design, software design and debugging.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_timer_manager_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TimerManager.h File Reference</div>  </div>
</div>
<div class="contents">

<p><a href="_timer_manager_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a>&#160;&#160;&#160;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a178539b13775c09952f086f301736823">TimerId_INVALID</a>&#160;&#160;&#160;0xFFFF</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a1a4e55390bd2c255ef6741d4c8e504d2">VoidFuncPtrType</a> )()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a085441a021a08b6e4e8b1c79f527e235">TimerExpiredCallback</a> )(<a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#aea407d92b89a8a17452396e218643e81">BeaconFrame_TimerExpiredCallback</a> )(void)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a11336a584cc006f34ca8285751c9c947">TimerInterface_Initialize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a9256dd24cf05129edaa1d04c393a9670">SetTimerReq</a> (<a class="el" href="_timer_manager_8h.html#a085441a021a08b6e4e8b1c79f527e235">TimerExpiredCallback</a> callbackPtr, unsigned int Period_Sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#aeab1b3689be6d745c5d5d00463509acf">CancelTimerReq</a> (<a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a> timerId)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#ae08656d11724a28201e82726cfa3218d">Reschedule_TimerReq</a> (<a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a> timerId, unsigned int Old_Period_Sec, unsigned int New_Period_Sec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#a6b7c846bc6100e4f9ace71467bcec906">One_Sec_ISR</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_timer_manager_8h.html#abbf30d0f326d41a8161ab387723caefe">Capture_TimerReq</a> (<a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a> timerId)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a79fd3eac646964332ed33ec7dd40f208"></a><!-- doxytag: member="TimerManager.h::MAX_TIMERS" ref="a79fd3eac646964332ed33ec7dd40f208" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TIMERS&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00021">21</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a178539b13775c09952f086f301736823"></a><!-- doxytag: member="TimerManager.h::TimerId_INVALID" ref="a178539b13775c09952f086f301736823" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TimerId_INVALID&#160;&#160;&#160;0xFFFF</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00022">22</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="aea407d92b89a8a17452396e218643e81"></a><!-- doxytag: member="TimerManager.h::BeaconFrame_TimerExpiredCallback" ref="aea407d92b89a8a17452396e218643e81" args=")(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="_timer_manager_8h.html#aea407d92b89a8a17452396e218643e81">BeaconFrame_TimerExpiredCallback</a>)(void)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00047">47</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a085441a021a08b6e4e8b1c79f527e235"></a><!-- doxytag: member="TimerManager.h::TimerExpiredCallback" ref="a085441a021a08b6e4e8b1c79f527e235" args=")(TimerId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="_timer_manager_8h.html#a085441a021a08b6e4e8b1c79f527e235">TimerExpiredCallback</a>)(<a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00046">46</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab6103af8c6ff5b7a7c9917ed82e06f72"></a><!-- doxytag: member="TimerManager.h::TimerId" ref="ab6103af8c6ff5b7a7c9917ed82e06f72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned int <a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00045">45</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1a4e55390bd2c255ef6741d4c8e504d2"></a><!-- doxytag: member="TimerManager.h::VoidFuncPtrType" ref="a1a4e55390bd2c255ef6741d4c8e504d2" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="_timer_manager_8h.html#a1a4e55390bd2c255ef6741d4c8e504d2">VoidFuncPtrType</a>)()</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8h_source.html#l00034">34</a> of file <a class="el" href="_timer_manager_8h_source.html">TimerManager.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aeab1b3689be6d745c5d5d00463509acf"></a><!-- doxytag: member="TimerManager.h::CancelTimerReq" ref="aeab1b3689be6d745c5d5d00463509acf" args="(TimerId timerId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CancelTimerReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>&#160;</td>
          <td class="paramname"><em>timerId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00170">170</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> criticalSectionSave;
    <span class="keywordflow">if</span>( timerId == <a class="code" href="_timer_manager_8h.html#a178539b13775c09952f086f301736823">TimerId_INVALID</a> || timerId &gt; <a class="code" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a> || <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].Required_Period_Sec == <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a>)
    {
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( criticalSectionSave );
    <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a>;
    <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#abe14cf8e6ab1918ddb3d493c83f4834f">Callback</a> = 0;
    <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( criticalSectionSave );
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abbf30d0f326d41a8161ab387723caefe"></a><!-- doxytag: member="TimerManager.h::Capture_TimerReq" ref="abbf30d0f326d41a8161ab387723caefe" args="(TimerId timerId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int Capture_TimerReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>&#160;</td>
          <td class="paramname"><em>timerId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00200">200</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//word16 criticalSectionSave;</span>
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CapturValue;
    <span class="comment">//BSP_ENTER_CRITICAL_SECTION( criticalSectionSave );</span>
    CapturValue = <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a>;
    <span class="comment">//BSP_EXIT_CRITICAL_SECTION( criticalSectionSave );</span>
    <span class="keywordflow">return</span> CapturValue;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6b7c846bc6100e4f9ace71467bcec906"></a><!-- doxytag: member="TimerManager.h::One_Sec_ISR" ref="a6b7c846bc6100e4f9ace71467bcec906" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void One_Sec_ISR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00266">266</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> criticalSectionSave;
  
     <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( criticalSectionSave );
    <span class="comment">//call all the expired timer callbacks</span>
    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a>; i++ )
    {
      <span class="keywordflow">if</span>( <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].Required_Period_Sec != <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a> )
      {
        <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a>--;
        <span class="keywordflow">if</span>( <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].Required_Period_Sec == 0 )
        {
            <span class="keywordflow">if</span>( <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].Callback != 0 )
            {
                <a class="code" href="_timer_manager_8h.html#a085441a021a08b6e4e8b1c79f527e235">TimerExpiredCallback</a> callback = *(<a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].<a class="code" href="struct_timer_inst.html#abe14cf8e6ab1918ddb3d493c83f4834f">Callback</a>);
                <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a>;
                <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].<a class="code" href="struct_timer_inst.html#abe14cf8e6ab1918ddb3d493c83f4834f">Callback</a> = 0;
                callback((<a class="code" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>)i );
            }
        }
      }
    }
    <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( criticalSectionSave );
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae08656d11724a28201e82726cfa3218d"></a><!-- doxytag: member="TimerManager.h::Reschedule_TimerReq" ref="ae08656d11724a28201e82726cfa3218d" args="(TimerId timerId, unsigned int Old_Period_Sec, unsigned int New_Period_Sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Reschedule_TimerReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>&#160;</td>
          <td class="paramname"><em>timerId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>Old_Period_Sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>New_Period_Sec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00226">226</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> criticalSectionSave;
    <span class="keywordtype">int</span> elapsed_time;
    
    <span class="keywordflow">if</span>( timerId == <a class="code" href="_timer_manager_8h.html#a178539b13775c09952f086f301736823">TimerId_INVALID</a> || timerId &gt; <a class="code" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a> || <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].Required_Period_Sec == <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a>)
    {
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
    
    
    elapsed_time = Old_Period_Sec - <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a>; <span class="comment">//Timer is already running. Calculate how much time is elapsed</span>
    
    <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( criticalSectionSave );
    <span class="keywordflow">if</span>(elapsed_time &gt;= New_Period_Sec)
      <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = 1; <span class="comment">//Already got the desired delay, Call ISR immediately in the next iteration.</span>
    <span class="keywordflow">else</span> 
      <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ timerId ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = New_Period_Sec - elapsed_time;  <span class="comment">//compensate for already elapsed time delay</span>
    <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( criticalSectionSave );
    
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9256dd24cf05129edaa1d04c393a9670"></a><!-- doxytag: member="TimerManager.h::SetTimerReq" ref="a9256dd24cf05129edaa1d04c393a9670" args="(TimerExpiredCallback callbackPtr, unsigned int Period_Sec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a> SetTimerReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_timer_manager_8h.html#a085441a021a08b6e4e8b1c79f527e235">TimerExpiredCallback</a>&#160;</td>
          <td class="paramname"><em>callbackPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>Period_Sec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00130">130</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> criticalSectionSave;
    <span class="comment">//find the 1st available timer</span>
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> foundID = <a class="code" href="_timer_manager_8h.html#a178539b13775c09952f086f301736823">TimerId_INVALID</a>;
    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a>; i++ )
    {
        <span class="keywordflow">if</span>( <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].Required_Period_Sec == <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a> &amp;&amp; foundID == <a class="code" href="_timer_manager_8h.html#a178539b13775c09952f086f301736823">TimerId_INVALID</a>)
        {
            foundID = i;
            <span class="keywordflow">break</span>;
        }
    }
    <a class="code" href="uart_8h.html#a4d19917ceac9ef0f757b861e802d22ad">BSP_ENTER_CRITICAL_SECTION</a>( criticalSectionSave );

    <span class="comment">//set callback and time</span>
    <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ foundID ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = Period_Sec;
    <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ foundID ].<a class="code" href="struct_timer_inst.html#abe14cf8e6ab1918ddb3d493c83f4834f">Callback</a> = callbackPtr;
    <a class="code" href="uart_8h.html#abd6fc0d94f04f101b14219891a771465">BSP_EXIT_CRITICAL_SECTION</a>( criticalSectionSave );

    <span class="keywordflow">return</span> (<a class="code" href="_timer_manager_8h.html#ab6103af8c6ff5b7a7c9917ed82e06f72">TimerId</a>)foundID;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a11336a584cc006f34ca8285751c9c947"></a><!-- doxytag: member="TimerManager.h::TimerInterface_Initialize" ref="a11336a584cc006f34ca8285751c9c947" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TimerInterface_Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_timer_manager_8c_source.html#l00083">83</a> of file <a class="el" href="_timer_manager_8c_source.html">TimerManager.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="_timer_manager_8h.html#a79fd3eac646964332ed33ec7dd40f208">MAX_TIMERS</a>; i++ )
    {
        <a class="code" href="_timer_manager_8c.html#ac4d15138ec25b1ad1649298e75948b21">Timers</a>[ i ].<a class="code" href="struct_timer_inst.html#a18d3dbce10d71fadb73defb02521997c">Required_Period_Sec</a> = <a class="code" href="_timer_manager_8c.html#ac26ebf4cea30152a586ab033907399bd">PERIOD_INVALID</a>;
    }
    
    T1CCTL0 = 0;    <span class="comment">/* Make sure interrupts are disabled */</span>
    T1CCTL1 = 0;    <span class="comment">/* Make sure interrupts are disabled */</span>
    T1CCTL2 = 0;    <span class="comment">/* Make sure interrupts are disabled */</span>
    T1CTL   = 0;
    
    <span class="comment">// clear interrupt pending flag, disable interrupt</span>
    T1IE  =  0; <span class="comment">// IEN1.T1EN = 0</span>
    
    CLKCON &amp;= ~<a class="code" href="clock_8h.html#a98ea8cbab1d8fb2a492924132ca8a682">TICKSPD_DIV_1</a>;
    CLKCON |= <a class="code" href="clock_8h.html#a98ea8cbab1d8fb2a492924132ca8a682">TICKSPD_DIV_1</a>;
    
    <span class="comment">// Set prescaler divider value to 128</span>
    T1CTL |= 0x0C;
    
    T1CC0L =  240;     <span class="comment">// Reset counter value</span>
    T1CC0H =  0;     <span class="comment">// Reset counter value</span>
    
    T1IE  =  1; <span class="comment">// IEN1.T1EN = 0</span>
    OVFIM = 1;
    
    <span class="comment">// Start timer in up/down mode</span>
    T1CTL |= 0x02; <span class="comment">// T1CTL.MODE = 01  </span>
    
    <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_timer_manager_8h.html">TimerManager.h</a>      </li>
      <li class="footer">Generated on Sat Apr 30 2011 08:30:26 for Embedded GarageBand by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
