<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Embedded GarageBand: key_map.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Picture1.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded GarageBand&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The project is aimed at developing an embedded Garage band that uses an 8051 microcontroller. The user can access the instruments via the touchscreen+graphics LCD or use the instruments that we have constructed. In this document we will cover the complete detail of the project including its construction, hardware design, software design and debugging.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('key__map_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">key_map.c</div>  </div>
</div>
<div class="contents">
<a href="key__map_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">  Filename:     key_map.h</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">  Description:  Specific Mappings of X-Y coordinates related to Touchscreen based Drums, Piano and Guitar.</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">        Developed by:   Niket Shah</span>
<a name="l00007"></a>00007 <span class="comment">                                        Maulik Kapuria</span>
<a name="l00008"></a>00008 <span class="comment">                                        Vishal Verma</span>
<a name="l00009"></a>00009 <span class="comment">***********************************************************************************/</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;<a class="code" href="hal__led_8h.html">hal_led.h</a>&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;<a class="code" href="hal__assert_8h.html">hal_assert.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="code" href="hal__board_8h.html">hal_board.h</a>&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;<a class="code" href="hal__int_8h.html">hal_int.h</a>&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="key__map_8h.html">key_map.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="uart__intfc_8h.html">uart_intfc.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="util_misc_8h.html">utilMisc.h</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">/***********************************************************************************</span>
<a name="l00020"></a>00020 <span class="comment">* @fn      piano_key_match</span>
<a name="l00021"></a>00021 <span class="comment">*</span>
<a name="l00022"></a>00022 <span class="comment">* @brief   It tries to match the input X-Y Co-ordinates with specific note/piano key</span>
<a name="l00023"></a>00023 <span class="comment">*</span>
<a name="l00024"></a>00024 <span class="comment">* @param   int x</span>
<a name="l00025"></a>00025 <span class="comment">*                        TouchScreen X-Coordinate</span>
<a name="l00026"></a>00026 <span class="comment">*                  int y</span>
<a name="l00027"></a>00027 <span class="comment">*                        TouchScreen Y-Coordinate</span>
<a name="l00028"></a>00028 <span class="comment">*</span>
<a name="l00029"></a>00029 <span class="comment">* @return  Piano Note</span>
<a name="l00030"></a>00030 <span class="comment">*/</span>
<a name="l00031"></a><a class="code" href="key__map_8h.html#af3049c32fad2cc56421e6d8e7d338192">00031</a> <span class="keywordtype">char</span> <a class="code" href="key__map_8c.html#af3049c32fad2cc56421e6d8e7d338192">piano_key_match</a>(<span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>, <span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#ac30de26db5f6d1c18c63913729adca7d">y</a>)
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033         <span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> BLACK_KEY = <a class="code" href="key__map_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00034"></a>00034         <span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> WHITE_KEY = <a class="code" href="key__map_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00035"></a>00035         <span class="keywordtype">char</span> key_note=0;
<a name="l00036"></a>00036         <span class="keywordtype">char</span> center_note = 0x3C;
<a name="l00037"></a>00037         
<a name="l00038"></a>00038         <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#adf807bcc86f6459965986b159c678cdc">xmin</a>,x,<a class="code" href="key__map_8h.html#a798e36e6287221a74d4e8d10d77af97d">xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a6e824bf0e26ad20b1251ebe3348f17e2">ymin</a>,y,<a class="code" href="key__map_8h.html#a79ac3b9ab90cbe206ca24c2ceea6c80d">ymax</a>))    <span class="comment">//check if it is in logical range of lcd</span>
<a name="l00039"></a>00039         {
<a name="l00040"></a>00040                 <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a194452c658184c1e3343c7996e6920fb">black_key_ymin</a> ,y ,<a class="code" href="key__map_8h.html#a468986daee6d8141309ed71317631670">black_key_ymax</a>))        <span class="comment">//check if it is a black key only</span>
<a name="l00041"></a>00041                 {                       
<a name="l00042"></a>00042                         <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a426affe5bfc2d7f7215628a1bde1551b">keyA_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a01bd785f6de507e3cd814fb264c35093">keyA_xmax</a>))                  <span class="comment">//check is key A is pressed</span>
<a name="l00043"></a>00043                         {
<a name="l00044"></a>00044                                 key_note=center_note - 16;
<a name="l00045"></a>00045                         }
<a name="l00046"></a>00046                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a4a9d9e6234fd92c8872b2cb762464e1a">keyB_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a3ec2225f3e1d2268b9f78e3323522477">keyB_xmax</a>))             <span class="comment">//check is key B is pressed</span>
<a name="l00047"></a>00047                         {
<a name="l00048"></a>00048                                 key_note=center_note - 10;
<a name="l00049"></a>00049                         }
<a name="l00050"></a>00050                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#afc6c0da12e23b070f7279c2c9c3fb0ef">keyC_xmin</a> ,x ,<a class="code" href="key__map_8h.html#aea6dcd43aac95380a990a2e4e7790cd0">keyC_xmax</a>))             <span class="comment">//check is key C is pressed</span>
<a name="l00051"></a>00051                         {
<a name="l00052"></a>00052                                 key_note=center_note - 4;
<a name="l00053"></a>00053                         }
<a name="l00054"></a>00054                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a9f2bc3a6814251feee89d153c8e901de">keyD_xmin</a> ,x ,<a class="code" href="key__map_8h.html#aad3791df24569de79f1b880f2482c536">keyD_xmax</a>))             <span class="comment">//check is key D is pressed</span>
<a name="l00055"></a>00055                         {
<a name="l00056"></a>00056                                 key_note=center_note + 2;
<a name="l00057"></a>00057                         }
<a name="l00058"></a>00058                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a8d5aeb19cf134cabf4d8179524a4290a">keyE_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a82a934823c8da99196ac9afc1ee3452b">keyE_xmax</a>))             <span class="comment">//check is key E is pressed</span>
<a name="l00059"></a>00059                         {
<a name="l00060"></a>00060                                 key_note=center_note + 8;
<a name="l00061"></a>00061                         }
<a name="l00062"></a>00062                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a9e83c3162492014b893e72e860f4bc80">keyF_xmin</a> ,x ,<a class="code" href="key__map_8h.html#afe19530259153284833edf569ab7e172">keyF_xmax</a>))             <span class="comment">//check is key F is pressed</span>
<a name="l00063"></a>00063                         {
<a name="l00064"></a>00064                                 key_note=center_note + 14;
<a name="l00065"></a>00065                         }
<a name="l00066"></a>00066                         <span class="keywordflow">else</span>
<a name="l00067"></a>00067                         {
<a name="l00068"></a>00068                                 BLACK_KEY = <a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00069"></a>00069                                 key_note=0;
<a name="l00070"></a>00070                                 <span class="comment">//printf(&quot;The key pressed is not a black key\n\r&quot;);</span>
<a name="l00071"></a>00071                         }
<a name="l00072"></a>00072                 }
<a name="l00073"></a>00073                 <span class="keywordflow">else</span>
<a name="l00074"></a>00074                 {
<a name="l00075"></a>00075                       BLACK_KEY = <a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00076"></a>00076                       key_note=0;
<a name="l00077"></a>00077                         <span class="comment">//printf(&quot;It is definately not a black Key. Check for white key\n\r&quot;);</span>
<a name="l00078"></a>00078                 }
<a name="l00079"></a>00079                 
<a name="l00080"></a>00080                 <span class="keywordflow">if</span>(BLACK_KEY==<a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)    <span class="comment">//see if black key is already found. WHy take pains to check for white key also.</span>
<a name="l00081"></a>00081                 {
<a name="l00082"></a>00082                         <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#aaa233b4be84bb2c4b17ece3433992ed5">key1_xmin</a> ,x ,<a class="code" href="key__map_8h.html#aa7d0b5b80954c1912ec7cc69e75bfc4e">key1_xmax</a>))  <span class="comment">//check if white key1 is pressed</span>
<a name="l00083"></a>00083                         {
<a name="l00084"></a>00084                                 key_note=center_note - 18;
<a name="l00085"></a>00085                         }
<a name="l00086"></a>00086                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a4ab3f040ddce19989b37010778508b63">key2_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a20e4d78adbca3c549e20a975bc17f04d">key2_xmax</a>))     <span class="comment">//check if white key2 is pressed</span>
<a name="l00087"></a>00087                         {
<a name="l00088"></a>00088                                 key_note=center_note - 14;
<a name="l00089"></a>00089                         }
<a name="l00090"></a>00090                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a3c0413a4dacea89414aebe35f1a9bf34">key3_xmin</a> ,x ,<a class="code" href="key__map_8h.html#ac4b9c87889e0f26afb76a9c60792a114">key3_xmax</a>))     <span class="comment">//check if white key3 is pressed</span>
<a name="l00091"></a>00091                         {
<a name="l00092"></a>00092                                 key_note=center_note - 12;
<a name="l00093"></a>00093                         }
<a name="l00094"></a>00094                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a0e5a615d9836ba6a4da9f98de328a622">key4_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a5692cb0a92ac429caa573dc4dc290d86">key4_xmax</a>))     <span class="comment">//check if white key4 is pressed</span>
<a name="l00095"></a>00095                         {
<a name="l00096"></a>00096                                 key_note=center_note - 8;
<a name="l00097"></a>00097                         }
<a name="l00098"></a>00098                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a6863ad3e9a7ff92f46bea1bb48a03b81">key5_xmin</a> ,x ,<a class="code" href="key__map_8h.html#ab2b90114f61ddd584c95486e21b79030">key5_xmax</a>))     <span class="comment">//check if white key5 is pressed</span>
<a name="l00099"></a>00099                         {
<a name="l00100"></a>00100                                 key_note=center_note - 6;
<a name="l00101"></a>00101                         }
<a name="l00102"></a>00102                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a02f2614aedfd290ff0537acb98b16788">key6_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a65082e1652d82f790ae386cac726a41f">key6_xmax</a>))     <span class="comment">//check if white key6 is pressed</span>
<a name="l00103"></a>00103                         {
<a name="l00104"></a>00104                                 key_note=center_note - 2;
<a name="l00105"></a>00105                         }
<a name="l00106"></a>00106                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a57d84d9e46b672379e28dca38dfa9611">key7_xmin</a> ,x ,<a class="code" href="key__map_8h.html#ae70a204b657ef7f4ee81d7361e4e8a32">key7_xmax</a>))     <span class="comment">//check if white key7 is pressed</span>
<a name="l00107"></a>00107                         {
<a name="l00108"></a>00108                                 key_note=center_note;
<a name="l00109"></a>00109                         }
<a name="l00110"></a>00110                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#aa1b781d76d0b5ac8ce16714a61c2f909">key8_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a2ce1fd1b3617846973161a31308c1c5a">key8_xmax</a>))     <span class="comment">//check if white key8 is pressed</span>
<a name="l00111"></a>00111                         {
<a name="l00112"></a>00112                                 key_note=center_note + 4;
<a name="l00113"></a>00113                         }
<a name="l00114"></a>00114                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a1ddbc1bc65e9eaa86f19a4ad084666b0">key9_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a37af65ebfcdd67b369cf64f4357de2c1">key9_xmax</a>))     <span class="comment">//check if white key9 is pressed</span>
<a name="l00115"></a>00115                         {
<a name="l00116"></a>00116                                 key_note=center_note + 6;
<a name="l00117"></a>00117                         }
<a name="l00118"></a>00118                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a6ff7eff5fe3da4456ea9d60002b04508">key10_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a6de02893d7e1b0ed49b73708def381c4">key10_xmax</a>))   <span class="comment">//check if white key10 is pressed</span>
<a name="l00119"></a>00119                         {
<a name="l00120"></a>00120                                 key_note=center_note + 10;
<a name="l00121"></a>00121                         }
<a name="l00122"></a>00122                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a771541dd4d00d4d56affb0eba6c483e1">key11_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a3af01e51638410c4cca7d71a9ac1f1d7">key11_xmax</a>))   <span class="comment">//check if white key11 is pressed</span>
<a name="l00123"></a>00123                         {
<a name="l00124"></a>00124                                 key_note=center_note + 12;
<a name="l00125"></a>00125                         }
<a name="l00126"></a>00126                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a3b5c83dc02c3040b0664c9a59b4f7b92">key12_xmin</a> ,x ,<a class="code" href="key__map_8h.html#af776adba6e2b52f0aaa5279b604b4ef7">key12_xmax</a>))   <span class="comment">//check if white key12 is pressed</span>
<a name="l00127"></a>00127                         {
<a name="l00128"></a>00128                                 key_note=center_note + 16;
<a name="l00129"></a>00129                         }
<a name="l00130"></a>00130                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a4ca555d6f110d3abdd914987b8108faa">key13_xmin</a> ,x ,<a class="code" href="key__map_8h.html#a73071da0cbbfe27abfa59882acb5e518">key13_xmax</a>))   <span class="comment">//check if white key13 is pressed</span>
<a name="l00131"></a>00131                         {
<a name="l00132"></a>00132                                 key_note=center_note + 18;
<a name="l00133"></a>00133                         }
<a name="l00134"></a>00134                         <span class="keywordflow">else</span>    <span class="comment">//touched within bounds. NO white key. No black key. SO what the hell is detected???</span>
<a name="l00135"></a>00135                         {
<a name="l00136"></a>00136                                 WHITE_KEY=<a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00137"></a>00137                                 key_note=0;
<a name="l00138"></a>00138                         }
<a name="l00139"></a>00139                 }
<a name="l00140"></a>00140                 <span class="keywordflow">else</span>    <span class="comment">//white key check ELSE</span>
<a name="l00141"></a>00141                 {
<a name="l00142"></a>00142                         WHITE_KEY=<a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00143"></a>00143                         <span class="comment">//printf(&quot;Not checking for white key. Black key already detected in the previous check\n\r&quot;);</span>
<a name="l00144"></a>00144                 }               <span class="comment">//END of white key check</span>
<a name="l00145"></a>00145         }       
<a name="l00146"></a>00146         <span class="keywordflow">else</span>    <span class="comment">//bound check else</span>
<a name="l00147"></a>00147         {
<a name="l00148"></a>00148                 BLACK_KEY=<a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00149"></a>00149                 WHITE_KEY=<a class="code" href="key__map_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00150"></a>00150                 <span class="comment">//printf(&quot;Data is out of Bounds. X = %d   Y = %d\n\r\n\r&quot;,x,y);</span>
<a name="l00151"></a>00151                 key_note=0;
<a name="l00152"></a>00152         }<span class="comment">//end of bound check</span>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         <span class="comment">//tx1_send(&amp;key_note, 1);</span>
<a name="l00155"></a>00155         <span class="keywordflow">return</span> key_note;
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">/***********************************************************************************</span>
<a name="l00161"></a>00161 <span class="comment">* @fn      ps2_key_match</span>
<a name="l00162"></a>00162 <span class="comment">*</span>
<a name="l00163"></a>00163 <span class="comment">* @brief   It tries to match the input PS/2 Keyboard ASCII key with specific note/piano key</span>
<a name="l00164"></a>00164 <span class="comment">*</span>
<a name="l00165"></a>00165 <span class="comment">* @param   char scancode</span>
<a name="l00166"></a>00166 <span class="comment">*                        Input ASCII Key by PS/2 KB</span>
<a name="l00167"></a>00167 <span class="comment">*</span>
<a name="l00168"></a>00168 <span class="comment">* @return  Piano Note</span>
<a name="l00169"></a>00169 <span class="comment">*/</span>
<a name="l00170"></a><a class="code" href="key__map_8h.html#a6420df595b5243ef586357f6d3026b7a">00170</a> <span class="keywordtype">char</span> <a class="code" href="key__map_8c.html#a6420df595b5243ef586357f6d3026b7a">ps2_key_match</a>(<span class="keywordtype">char</span> scancode)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172         <span class="keywordtype">char</span> i=0;
<a name="l00173"></a>00173         <span class="keywordtype">char</span> keynote=0;
<a name="l00174"></a>00174         <span class="keywordtype">char</span> base_keynote = 0x3C-18;
<a name="l00175"></a>00175         
<a name="l00176"></a>00176         <span class="keywordflow">for</span>(i=0;i&lt;19;i++)
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178                 <span class="keywordflow">if</span>(scancode == <a class="code" href="key__map_8h.html#a14e0e6304e61b34c92d06b49be414f30">valid_scancode</a>[i])
<a name="l00179"></a>00179                 {
<a name="l00180"></a>00180                         keynote = base_keynote + (i*2);
<a name="l00181"></a>00181                         <span class="keywordflow">break</span>;
<a name="l00182"></a>00182                 }
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184         <span class="keywordflow">return</span> keynote;
<a name="l00185"></a>00185 }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">//DRUMS STUFF------------------------------</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/***********************************************************************************</span>
<a name="l00192"></a>00192 <span class="comment">* @fn      drum_key_match</span>
<a name="l00193"></a>00193 <span class="comment">*</span>
<a name="l00194"></a>00194 <span class="comment">* @brief   It tries to match the input X-Y Co-ordinates with specific note/drum key</span>
<a name="l00195"></a>00195 <span class="comment">*</span>
<a name="l00196"></a>00196 <span class="comment">* @param   int x</span>
<a name="l00197"></a>00197 <span class="comment">*                        TouchScreen X-Coordinate</span>
<a name="l00198"></a>00198 <span class="comment">*                  int y</span>
<a name="l00199"></a>00199 <span class="comment">*                        TouchScreen Y-Coordinate</span>
<a name="l00200"></a>00200 <span class="comment">*</span>
<a name="l00201"></a>00201 <span class="comment">* @return  Drum Note</span>
<a name="l00202"></a>00202 <span class="comment">*/</span>
<a name="l00203"></a><a class="code" href="key__map_8h.html#a3166274512fcdfbebc49c2198d15e1d2">00203</a> <span class="keywordtype">char</span> <a class="code" href="key__map_8c.html#a3166274512fcdfbebc49c2198d15e1d2">drum_key_match</a>(<span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>, <span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#ac30de26db5f6d1c18c63913729adca7d">y</a>)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205         <span class="keywordtype">char</span> key_note = 0;
<a name="l00206"></a>00206         
<a name="l00207"></a>00207         <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#adf807bcc86f6459965986b159c678cdc">xmin</a>,x,<a class="code" href="key__map_8h.html#a798e36e6287221a74d4e8d10d77af97d">xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a6e824bf0e26ad20b1251ebe3348f17e2">ymin</a>,y,<a class="code" href="key__map_8h.html#a79ac3b9ab90cbe206ca24c2ceea6c80d">ymax</a>))    <span class="comment">//check if it is in logical range of lcd</span>
<a name="l00208"></a>00208         {
<a name="l00209"></a>00209                 <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a3e87118695527b5132c69e34b65ed420">square1_xmin</a>, x, <a class="code" href="key__map_8h.html#ac354b528533e27dd15193d0d983cc16e">square1_xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a9fafb57ce9059ca4f4d9f9c58e786564">square1_ymin</a>, y, <a class="code" href="key__map_8h.html#aa08f265f7c3034cd4760850d3f037e77">square1_ymax</a>))
<a name="l00210"></a>00210                                 key_note = 40;          <span class="comment">//Drum 1 SNARE DRUM</span>
<a name="l00211"></a>00211                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a2342672393a112f0f9a1b1ff75ee4b15">square2_xmin</a>, x, <a class="code" href="key__map_8h.html#a3be51197899cc606bf61f2f0d66a9f4a">square2_xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ad1474b8cbf56b7f8b2038c63edb1b8b4">square2_ymin</a>, y, <a class="code" href="key__map_8h.html#a570ef484106dd5b4edb7fda4d035384b">square2_ymax</a>))
<a name="l00212"></a>00212                                 key_note = 36;          <span class="comment">//Drum 2 Bass drum      </span>
<a name="l00213"></a>00213                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a9f0355d0de4d8bea80f85d479b8b2345">square3_xmin</a>, x, <a class="code" href="key__map_8h.html#a293770f89ea9e067158485026e6dc53b">square3_xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a4c4eb78af698c34b971a51aebf5b995a">square3_ymin</a>, y, <a class="code" href="key__map_8h.html#ab58db953185f5f59feadf1580d891a9f">square3_ymax</a>))
<a name="l00214"></a>00214                                 key_note = 48;          <span class="comment">//drum 3 Tom Tom drum</span>
<a name="l00215"></a>00215                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a99ec7028692fbd06df79b8f50a3a4c20">square4_xmin</a>, x, <a class="code" href="key__map_8h.html#a18603e55d8b9fe8f1276c0b6bc7a3cef">square4_xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ad26f431dcb040c1aebbe703a02ee5f84">square4_ymin</a>, y, <a class="code" href="key__map_8h.html#af4270f8d4cd97214033be88a7f5eb67a">square4_ymax</a>))
<a name="l00216"></a>00216                                 key_note = 41;          <span class="comment">//Drum 4 Low Floor tom</span>
<a name="l00217"></a>00217                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a77e3559790be3d4a3ca4a056dd78fcff">square5_xmin</a>, x, <a class="code" href="key__map_8h.html#a6b79aa96417edb44d2ff9a280d55db9f">square5_xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ad62b6cb4f20c16359b1c5c5e09857787">square5_ymin</a>, y, <a class="code" href="key__map_8h.html#abde9a80e54142d3500249ebe329270ae">square5_ymax</a>))
<a name="l00218"></a>00218                                 key_note = 51;          <span class="comment">//Cymbal ride cymbal 1</span>
<a name="l00219"></a>00219                 <span class="keywordflow">else</span>
<a name="l00220"></a>00220                         key_note = 0;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223                 <span class="keywordflow">else</span>    <span class="comment">//bound check else</span>
<a name="l00224"></a>00224         {
<a name="l00225"></a>00225                 key_note=0;
<a name="l00226"></a>00226         }<span class="comment">//end of bound check</span>
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="comment">//tx1_send(&amp;key_note, 1);</span>
<a name="l00229"></a>00229         <span class="keywordflow">return</span> key_note;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment">/***********************************************************************************</span>
<a name="l00233"></a>00233 <span class="comment">* @fn      guitar_key_match</span>
<a name="l00234"></a>00234 <span class="comment">*</span>
<a name="l00235"></a>00235 <span class="comment">* @brief   It tries to match the input X-Y Co-ordinates with specific note/Guitar string</span>
<a name="l00236"></a>00236 <span class="comment">*</span>
<a name="l00237"></a>00237 <span class="comment">* @param   int x</span>
<a name="l00238"></a>00238 <span class="comment">*                        TouchScreen X-Coordinate</span>
<a name="l00239"></a>00239 <span class="comment">*                  int y</span>
<a name="l00240"></a>00240 <span class="comment">*                        TouchScreen Y-Coordinate</span>
<a name="l00241"></a>00241 <span class="comment">*</span>
<a name="l00242"></a>00242 <span class="comment">* @return  Guitar Note</span>
<a name="l00243"></a>00243 <span class="comment">*/</span>
<a name="l00244"></a><a class="code" href="key__map_8h.html#afb072f082875e10ecfa61a10df3a3765">00244</a> <span class="keywordtype">char</span> <a class="code" href="key__map_8c.html#afb072f082875e10ecfa61a10df3a3765">guitar_key_match</a>(<span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#a676e0da0ef83bbbdf42538e54b97506b">x</a>, <span class="keywordtype">int</span> <a class="code" href="_touch_screen_8h.html#ac30de26db5f6d1c18c63913729adca7d">y</a>)
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246         <span class="keywordtype">char</span> key_note=0;
<a name="l00247"></a>00247         
<a name="l00248"></a>00248         <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#adf807bcc86f6459965986b159c678cdc">xmin</a>,x,<a class="code" href="key__map_8h.html#a798e36e6287221a74d4e8d10d77af97d">xmax</a>) &amp;&amp; <a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a6e824bf0e26ad20b1251ebe3348f17e2">ymin</a>,y,<a class="code" href="key__map_8h.html#a79ac3b9ab90cbe206ca24c2ceea6c80d">ymax</a>))    <span class="comment">//check if it is in logical range of lcd</span>
<a name="l00249"></a>00249         {
<a name="l00250"></a>00250                 <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ae9fd5f9936c30243cc1da223d2fbcf76">string1_ymin</a>, y, <a class="code" href="key__map_8h.html#af5ec44912ee60251f3f84c83bb8ed33d">string1_ymax</a>))    <span class="comment">//String 1 Thickest string</span>
<a name="l00251"></a>00251                         key_note = 52;
<a name="l00252"></a>00252                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a44ba35f3e27a6a87f4d261a452a63be4">string2_ymin</a>, y, <a class="code" href="key__map_8h.html#aa6eb8c06d5e8c0a7c48e84c1a368b586">string2_ymax</a>))       <span class="comment">//String 2</span>
<a name="l00253"></a>00253                         key_note = 57;
<a name="l00254"></a>00254                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a00715dda48b118a2120b75bf9a3145cd">string3_ymin</a>, y, <a class="code" href="key__map_8h.html#a784ff0fc5aa1a5fb34b3757000d36eb3">string3_ymax</a>))       <span class="comment">//String 3</span>
<a name="l00255"></a>00255                         key_note = 62;
<a name="l00256"></a>00256                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ab2f2d6f3633343c0c3ac751ab844b260">string4_ymin</a>, y, <a class="code" href="key__map_8h.html#a184be14e92a329374884427fe3b9570e">string4_ymax</a>))       <span class="comment">//String 4</span>
<a name="l00257"></a>00257                         key_note = 67;
<a name="l00258"></a>00258                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#a251e54a0db82b8ba496348cf729769c2">string5_ymin</a>, y, <a class="code" href="key__map_8h.html#a0149d8aa910d5347855c296e1850b84b">string5_ymax</a>))       <span class="comment">//String 5</span>
<a name="l00259"></a>00259                         key_note = 71;
<a name="l00260"></a>00260                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="key__map_8h.html#a7d3a67966d59945543298ac00709fb9e">ISBETWEEN</a>(<a class="code" href="key__map_8h.html#ae6bad169fec17ca2968c0f72eafa9b65">string6_ymin</a>, y, <a class="code" href="key__map_8h.html#aef6fabeac686d91d7fd8ad5345e826a7">string6_ymax</a>))       <span class="comment">//String 6</span>
<a name="l00261"></a>00261                         key_note = 76;
<a name="l00262"></a>00262                 <span class="keywordflow">else</span>
<a name="l00263"></a>00263                         key_note=0;
<a name="l00264"></a>00264         
<a name="l00265"></a>00265         }       
<a name="l00266"></a>00266         <span class="keywordflow">else</span>    <span class="comment">//bound check else</span>
<a name="l00267"></a>00267         {
<a name="l00268"></a>00268                 key_note=0;
<a name="l00269"></a>00269         }<span class="comment">//end of bound check</span>
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="keywordflow">return</span> key_note;
<a name="l00272"></a>00272 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="key__map_8c.html">key_map.c</a>      </li>
      <li class="footer">Generated on Sat Apr 30 2011 08:30:24 for Embedded GarageBand by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
